# 분석-순위 함수를 사용한 SQL 실습 문제

## 문제 1: 각 배우의 총 출연 횟수와 순위를 계산하라
각 배우의 출연 횟수를 계산하고, 이를 기준으로 순위를 매기는 문제입니다.

각 배우가 출연한 횟수를 구한 후, 출연 횟수에 대한 순위를 부여합니다.

![image](https://github.com/user-attachments/assets/4c57a5da-6584-46c5-b612-de477fb0d500)

## 문제 2: 각 영화의 총 대여 횟수와 해당 영화의 순위 계산 - 동순위 처리 필요
영화별로 대여 횟수를 계산하고, 대여 횟수에 따른 순위를 매기는 문제입니다. 대여 횟수가 같은 영화가 있을 경우 동순위를 처리해야 합니다.

![image](https://github.com/user-attachments/assets/3b524e76-e8b1-4ff7-a96a-f2143a1f90e3)


## 문제 3: 각 고객의 대여 횟수와 고객의 순위 계산
각 고객이 대여한 총 횟수를 계산하고, 이를 기준으로 고객의 순위를 계산합니다.

![image](https://github.com/user-attachments/assets/4ca956f4-5b21-475b-aaa4-44f8becd5e22)


## 문제 4: 대여가 가장 많은 직원과 그 순위 계산
직원별로 대여 건수를 계산하고, 대여 건수를 기준으로 직원 순위를 매깁니다.

![image](https://github.com/user-attachments/assets/bcdd8201-a2a8-4a5e-a807-7fd09b5b8653)


## 문제 5: 각 카테고리에서 가장 많이 대여된 영화의 순위
각 카테고리별로 가장 많이 대여된 영화를 찾아 그 순위를 계산합니다. 카테고리별로 순위를 나누어 처리해야 합니다.

![image](https://github.com/user-attachments/assets/c61b9156-bf0e-4975-abee-5ec9bedccc7a)

![image](https://github.com/user-attachments/assets/88807a60-8323-4ab6-be0a-8b84af52d998)

## 문제 6: 각 배우가 출연한 영화의 평균 대여 횟수와 순위
배우별로 출연한 영화들의 평균 대여 횟수를 계산하고, 이를 기준으로 순위를 매깁니다.

![image](https://github.com/user-attachments/assets/7cdace4d-d968-4d7f-b1e5-b5ad35d7f697)


## 문제 7: 각 고객의 평균 대여 기간과 순위 계산
각 고객이 대여한 영화들의 평균 대여 기간을 계산하고, 이를 기준으로 순위를 매깁니다.

![image](https://github.com/user-attachments/assets/79945e1c-700c-4749-9b6c-63a298221f94)


## 문제 8: 각 직원이 처리한 대여 건수의 누적 합계
직원별로 처리한 대여 건수의 누적 합계를 계산합니다. 시간순으로 누적 대여 건수를 계산하여 순위를 매깁니다.

![image](https://github.com/user-attachments/assets/50a16e4b-8b8e-42d5-afae-23dbf545c93e)


## 문제 9: 각 영화의 평균 대여 기간과 순위 계산
각 영화의 평균 대여 기간을 계산하고, 이를 기준으로 영화 순위를 매깁니다.

![image](https://github.com/user-attachments/assets/158d437a-69c6-4fd7-9cb4-95234d3a7159)


## 문제 10: 각 카테고리별 평균 대여 횟수의 순위 계산
각 카테고리별로 영화의 평균 대여 횟수를 계산하고, 이를 기준으로 카테고리 순위를 매깁니다.

![image](https://github.com/user-attachments/assets/03e24ec7-30d9-4e7c-842c-11c30882be5e)


## 문제 11: 대여 횟수가 가장 많은 고객을 나라별로 구분하여 순위 계산
각 나라별로 대여 횟수가 가장 많은 고객을 찾아 그 순위를 매깁니다.

![image](https://github.com/user-attachments/assets/080c3a89-13fa-4808-8ce6-f8230d2d87b2)


## 문제 12: 특정 날짜 범위에서 각 카테고리의 누적 대여 횟수 계산
주어진 날짜 범위 내에서 각 카테고리별로 누적 대여 횟수를 계산합니다.

![image](https://github.com/user-attachments/assets/76b91efe-c8b2-4648-9b7e-3e10ed197155)


## 문제 13: 가장 많이 대여된 영화 TOP 5의 대여 횟수와 순위
대여 횟수가 많은 상위 5개의 영화를 찾아 그 대여 횟수와 순위를 매깁니다.

![image](https://github.com/user-attachments/assets/afafd18d-a400-4470-8544-2bae9bc169ff)


## 문제 14: 대여된 영화의 평균 수익과 순위 계산
대여된 영화들의 평균 수익을 계산하고, 수익에 따른 영화 순위를 매깁니다.

![image](https://github.com/user-attachments/assets/407e5c5b-de2b-4ee9-9f7a-58c49c839d32)


## 문제 15: 특정 배우(PENELOPE GUINESS)가 출연한 영화 중 가장 높은 수익을 낸 영화 순위 조회
특정 배우가 출연한 영화들 중에서 가장 높은 수익을 낸 영화의 순위를 조회합니다.

![image](https://github.com/user-attachments/assets/4a20cb24-dcd2-4582-b6c3-e68112ca5342)


## 문제 16: 대여 금액이 가장 높은 고객 TOP 10 계산
대여 금액이 가장 높은 상위 10명의 고객을 찾아 순위를 매깁니다.

![image](https://github.com/user-attachments/assets/f6b003d8-51b6-4a93-b2d6-c094a20d6c49)


## 문제 17: 매월 총 수익 계산과 월별 순위
각 월별 총 수익을 계산하고, 월별 수익에 따른 순위를 매깁니다.

![image](https://github.com/user-attachments/assets/d1e64936-f6ea-40d5-b95c-e2ce3892396b)


## 문제 18: 각 배우별 평균 수익과 순위 계산 - 상위 5명 조회
각 배우별로 평균 수익을 계산하고, 이를 기준으로 상위 5명의 배우를 조회합니다.

![image](https://github.com/user-attachments/assets/4b11a667-8d17-4a05-9385-16839102055b)


## 문제 19: 각 지역별 총 대여 수익과 순위 - 상위 5개 조회
각 지역별로 총 대여 수익을 계산하고, 이를 기준으로 상위 5개 지역을 조회합니다.

![image](https://github.com/user-attachments/assets/80f0c6bd-6c7e-4eeb-aa4c-9f434f3236f2)


## 문제 20: 대여 횟수가 가장 많은 배우 10명과 출연 영화 횟수
대여 횟수가 많은 상위 10명의 배우를 찾아, 그들의 출연 영화 횟수도 함께 조회합니다.

![image](https://github.com/user-attachments/assets/da9081c1-75e0-4f81-b707-73a94161820c)


## 문제 21: 고객별 결제 금액 추세 비교 (이전/다음 결제 금액으로부터 증감 계산)
각 고객별로 결제일 기준으로 이전 결제 금액과 다음 결제 금액을 비교하여, 결제 금액의 변화를 추적합니다.

![image](https://github.com/user-attachments/assets/8e62daad-97d8-4de5-b845-8250b50870ca)

