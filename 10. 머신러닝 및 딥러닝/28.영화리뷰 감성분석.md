
```
%pip install transformers datasets accelerate evaluate
```
![image](https://github.com/user-attachments/assets/6c490665-c112-46e3-a40c-6ced8a19c902)

```
# 영화리뷰 데이터 로드
import gzip
import shutil
import time

import pandas as pd
import requests
import torch
import torch.nn.functional as F
import torchtext

import transformers
from transformers import DistilBertTokenizerFast # 토크나이저저
from transformers import DistilBertForSequenceClassification # 분류 모델
```
```
torch.backends.cudnn.deterministic = True # PyTorch에서 CUDA를 사용하는 딥러닝 모델의 연산 결과를 "결정론적(deterministic)"으로 만들지 여부를 설정하는 옵션입니다.
RANDOM_SEED = 123
torch.manual_seed(RANDOM_SEED)
DEVICE = torch.device('cuda' if torch.cuda.is_available() else 'cpu')

NUM_EPOCHS = 3
```
```
url = "https://github.com/rasbt/machine-learning-book/raw/main/ch08/movie_data.csv.gz"
filename = url.split("/")[-1]

with open(filename, "wb") as f:
    r = requests.get(url)
    f.write(r.content)

with gzip.open('movie_data.csv.gz', 'rb') as f_in:
    with open('movie_data.csv', 'wb') as f_out:
        shutil.copyfileobj(f_in, f_out)
```
![image](https://github.com/user-attachments/assets/63b0155f-5313-4632-86bd-70826cfb5ef4)

```
df = pd.read_csv('movie_data.csv')
df.head()
```
![image](https://github.com/user-attachments/assets/068a2527-ac30-4cec-b555-f557f8f418bf)

```
train_texts = df.iloc[:35000]['review'].values
train_labels = df.iloc[:35000]['sentiment'].values

valid_texts = df.iloc[35000:40000]['review'].values
valid_labels = df.iloc[35000:40000]['sentiment'].values

test_texts = df.iloc[40000:]['review'].values
test_labels = df.iloc[40000:]['sentiment'].values
```
```
# 토큰나이저
tokenizer = DistilBertTokenizerFast.from_pretrained('distilbert-base-uncased') # uncased는 대소문자 무시
```
![image](https://github.com/user-attachments/assets/d7105f2f-890a-4ddd-a56e-f2611251b8e2)

