# ìì „ê±° ëŒ€ì—¬ ìˆ˜ìš” ì˜ˆì¸¡

[ìì „ê±° ëŒ€ì—¬ ìˆ˜ìš” ì˜ˆì¸¡](https://www.kaggle.com/competitions/bike-sharing-demand)

```
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
%matplotlib inline


import warnings
warnings.filterwarnings("ignore", category=RuntimeWarning)


bike_df = pd.read_csv('./train.csv')
print(bike_df.shape)
bike_df.head(3)
```
![image](https://github.com/user-attachments/assets/d1222015-451f-428d-8416-e93c4e14bdd7)

```
bike_df.info()
```
![image](https://github.com/user-attachments/assets/b21552db-034d-44d2-99c3-fbb042e120cd)

```
# ë¬¸ìì—´ë¡œ ë˜ì–´ ìˆëŠ” dataetime í”¼ì³ ê°’ì„ datetime íƒ€ì…ìœ¼ë¡œ ë³€í™˜
# bike_df['datetime']=bike_df.datetime.apply(pd.to_datetime)
bike_df['datetime']=bike_df.datetime.apply(pd.to_datetime)

bike_df.info()
```
![image](https://github.com/user-attachments/assets/92bf13fc-cea4-43c0-b848-14c8b0e68386)

```
# year feature ìƒˆë¡œ ìƒì„±
bike_df['year']=bike_df.datetime.apply(lambda x:x.year)
bike_df.info()
```
![image](https://github.com/user-attachments/assets/0ec6f98f-94bc-4922-9373-71c965df66b4)

```
bike_df['year']
```
![image](https://github.com/user-attachments/assets/33251b7b-4cfd-4394-b5a2-4b21533aa945)

```
# month feature ìƒˆë¡œ ìƒì„±
bike_df['month']=bike_df.datetime.apply(lambda x:x.month)
# day feature ìƒˆë¡œ ìƒì„±
bike_df['day']=bike_df.datetime.apply(lambda x:x.day)
# hour feature ìƒˆë¡œ ìƒì„±
bike_df['hour']=bike_df.datetime.apply(lambda x:x.hour)
# minute feature ìƒˆë¡œ ìƒì„±
bike_df['minute']=bike_df.datetime.apply(lambda x:x.minute)
```

```
bike_df.head(20)
```
![image](https://github.com/user-attachments/assets/3f927b99-fd7f-48de-ac58-2d70cb64b85d)

```
# count = casual + registered ì´ë¯€ë¡œ í•„ìš”í•œ ë°ì´í„°ê°€ ì•„ë‹ˆë‹¤
drop_columns=['datetime','casual','registered','minute']
bike_df.drop(
    drop_columns
    ,axis=1
    ,inplace=True
)

bike_df.columns
```
![image](https://github.com/user-attachments/assets/2fdaa6ce-5add-41d6-980e-5be0e5562c5a)

```
# í”¼ì³ì˜ ë¶„í¬ í™•ì¸
cat_features=[
    'year'
    ,'month'
    ,'season'
    ,'weather'
    ,'day'
    ,'hour'
    ,'workingday'
    ,'holiday'
]

# ë§‰ëŒ€ ê·¸ë˜í”„ë¡œ ë¶„í¬ í™•ì¸
fig,axs=plt.subplots(
    figsize=(15,8)
    ,ncols=4
    ,nrows=2
)

for i, feature in enumerate(cat_features):
    row=int(i/4)
    col=i%4
    sns.barplot(
        data=bike_df
        ,x=feature
        ,y='count'
        ,ax=axs[row][col]
    )
    
plt.show()
```
![image](https://github.com/user-attachments/assets/313c5add-a1ac-4d71-9612-3e1b2cc61f05)

```
# label ë˜ëŠ” ì¤‘ìš” featureê°€ ì •ê·œ ë¶„í¬ë¥¼ ë”°ë¥´ëŠ”ì§€ í™•ì¸ì„ í•´ì•¼í•œë‹¤
# ì •ê·œ ë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•Šìœ¼ë©´ ëª¨ë¸ì˜ ì„±ëŠ¥ì´ ì €í•˜ ë  ìˆ˜ ìˆë‹¤
# ë”°ë¼ì„œ ë°ì´í„° ì „ì²˜ë¦¬ ê³¼ì •ì—ì„œ ë°ì´í„° ë¶„í¬ë¥¼ í™•ì¸í•˜ê³  ì •ê·œ ë¶„í¬ë¡œ ë³€í™˜ ì‘ì—…ì´ í•„ìš”í•˜ë‹¤
# ex) log ë³€í™˜, ì œê³±ê·¼ ë³€í™˜ ë“± ì •ê·œ ë¶„í¬ í˜•íƒœë¡œ ë³€í™˜ì´ í•„ìš” í•  ìˆ˜ ìˆë‹¤
# íŠ¸ë¦¬ ê¸°ë°˜ ëª¨ë¸ì€ ì •ê·œ ë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•Šì•„ë„ ì„±ëŠ¥ ì €í•˜ê°€ ì—†ì„ ìˆ˜ ìˆë‹¤
bike_df['count'].hist(bins=30)
plt.show()
```
![image](https://github.com/user-attachments/assets/00671770-99dd-431e-ab2e-736825812d42)

```
# í‰ê°€ ì§€í‘œ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜ ì„ ì–¸
def rmsle_(y,pred):
    log_y=np.log1p(y)
    log_pred=np.log1p(pred)
    
    squared_error=(log_y-log_pred)**2
    rmsle=np.sqrt(np.mean(squared_error))
    return rmsle

def rmse_(y,pred):
    from sklearn.metrics import mean_squared_error
    return np.sqrt(np.mean(mean_squared_error(y, pred)))

def evaluate_regr(y,pred):
    from sklearn.metrics import mean_absolute_error
    rmsle=rmsle_(y,pred)
    rmse=rmse_(y,pred)
    mae_val=mean_absolute_error(y,pred)
    print(f'RMSLE : {rmsle}, RMSE : {rmse}, MAE : {mae_val}')
```
```
# ì „ì²˜ë¦¬ ì—†ì´ ëª¨ë¸ ìƒì„±í•˜ê³  í•™ìŠµí•˜ê³  í‰ê°€
from sklearn.model_selection import train_test_split,GridSearchCV
from sklearn.linear_model import LinearRegression,Ridge,Lasso

# ë°ì´í„°ì™€ ë ˆì´ë¸” ë¶„ë¦¬
y_target=bike_df['count']
X_features=bike_df.drop(['count'],axis=1,inplace=False)

# í•™ìŠµ/í…ŒìŠ¤íŠ¸ ë¶„ë¦¬
X_train,X_test,y_train,y_test=train_test_split(
    X_features
    ,y_target
    ,test_size=0.3
    ,random_state=0
)

# ëª¨ë¸ ìƒì„± : LinearRegression() : ë‹¨ìˆœ ì„ í˜• íšŒê·€ ëª¨ë¸(ê·œì œê°€ ì—†ë‹¤)
lr_reg=LinearRegression()

#í•™ìŠµ
lr_reg.fit(X_train,y_train)

# ì˜ˆì¸¡ê°’ ì¶”ì¶œ
pred=lr_reg.predict(X_test)

evaluate_regr(y_test,pred)
```
![image](https://github.com/user-attachments/assets/f1260eae-4eb0-4be0-8c06-8d3ed0738d9c)

```
# ì‹¤ì œ ë°ì´í„°ë¡œ ìœ„ ì˜¤ì°¨ê°€ ì™œ ë‚˜ì™”ëŠ”ì§€ í™•ì¸
print(f'y_test shape : {y_test.shape}')
print('='*100)
print(y_test[:10])
print('='*100)
print(pred[:10])
print('='*100)

ry_test = y_test[:10]
py_test = pred[:10]
diff_ = ry_test - py_test

print(f'ì‹¤ì œ ëŒ€ì—¬ìˆ˜: {ry_test}\n\nì˜ˆì¸¡ ëŒ€ì—¬ìˆ˜ : {py_test}\n\n ì°¨ì´ : {diff_}')
```
```
y_test shape : (3266,)
====================================================================================================
6638     244
7975     239
5915     229
8050     467
5894     335
1466      40
10710    329
5138       2
1726     141
3943     391
Name: count, dtype: int64
====================================================================================================
[320.78637463 251.1873687  241.70971289 388.81803967 291.19455149
 258.94555635 298.59067233  62.04770396 260.3810481  166.45421786]
====================================================================================================
ì‹¤ì œ ëŒ€ì—¬ìˆ˜: 6638     244
7975     239
5915     229
8050     467
5894     335
1466      40
10710    329
5138       2
1726     141
3943     391
Name: count, dtype: int64

ì˜ˆì¸¡ ëŒ€ì—¬ìˆ˜ : [320.78637463 251.1873687  241.70971289 388.81803967 291.19455149
 258.94555635 298.59067233  62.04770396 260.3810481  166.45421786]

 ì°¨ì´ : 6638     -76.786375
7975     -12.187369
5915     -12.709713
8050      78.181960
5894      43.805449
1466    -218.945556
10710     30.409328
5138     -60.047704
1726    -119.381048
3943     224.545782
Name: count, dtype: float64
```

```
# ì˜¤ì°¨ ìƒìœ„ nê°œ í™•ì¸ í•¨ìˆ˜ : ì •ë ¬ í•„ìš”
def get_top_error_data(y_test,pred,n_tops=5):
    result_df=pd.DataFrame(
        y_test.values
        ,columns=['real_count']
    )
    result_df['predict_count']=np.round(pred)
    result_df['diff']=np.abs(result_df['real_count']-result_df['predict_count'])
    print(result_df.sort_values('diff',ascending=False)[:n_tops])

get_top_error_data(y_test,pred)
```
![image](https://github.com/user-attachments/assets/e7ea91ff-a71b-490f-bbf1-08701a4dc43b)

```
y_target.hist()
plt.show()
```
![image](https://github.com/user-attachments/assets/b28c6056-1c3f-42f0-a28c-abf9c05d742f)

```
y_log_transform=np.log1p(y_target)
y_log_transform.hist()
plt.show()
```
![image](https://github.com/user-attachments/assets/dc23c3fc-9f1b-4422-9ca8-e019e62282dd)

```
# ì‹œê°í™” QQ plot, ì •ëŸ‰í™”ëœ ê°’ì„ í™•ì¸ : shaprio value
from scipy import stats
stats.probplot(y_target,dist='norm',plot=plt) 
plt.title('y_target Q-Q plot')
plt.show()
```
![image](https://github.com/user-attachments/assets/6f8005e8-d4aa-470b-b28e-0023ae004b9a)

```
from scipy.stats import shapiro
stat,p=shapiro(y_target)

if p>0.05:
    print('ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤')
else:
    print(f'P-value : {p}, ì •ê·œ ë¶„í¬ë¥¼ ì•ˆë”°ë¥¸ë‹¤, ë¡œê·¸ ë°˜í™˜ í•„ìš”!!!')
```
![image](https://github.com/user-attachments/assets/56d98c53-e479-4844-aade-0e031b073a41)

```
# target log
y_target_log=np.log1p(y_target)

X_tr,X_tst,y_tr,y_tst=train_test_split(
    X_features
    ,y_target_log
    ,test_size=0.3
    ,random_state=0
)

lr_reg=LinearRegression()
lr_reg.fit(X_tr,y_tr)
pred=lr_reg.predict(X_tst)

# ì˜ˆì¸¡ ëŒ€ì—¬ ëŒ€ìˆ˜ ë¡œê·¸ ê°’ì„ ê°€ì§€ê³  ì‡ë‹¤ => ì§€ìˆ˜í•¨ìˆ˜ ì‚¬ìš©
y_tst_exp=np.expm1(y_tst) # y_tst logë³€í™˜ ëœê±¸ ì›ë˜ ëŒ€ìˆ˜ë¡œ ë³€ê²½
pred_exp=np.expm1(pred)

evaluate_regr(y_tst_exp,pred_exp)
```
![image](https://github.com/user-attachments/assets/fbf9a379-5d24-4351-8089-7f0957180f57)

```
# ê³„ìˆ˜ ê°’ë“¤ì„ í™•ì¸ : ì–´ë–¤ í”¼ì³ê°€ ì¤‘ìš”í•œ ì—­í•  íŒŒì•…
coef_=pd.Series(
    lr_reg.coef_
    ,index=X_features.columns
)
print(f'ê³„ìˆ˜ ê°’\n{coef_}')

coef_sort=coef_.sort_values(ascending=False)

sns.barplot(x=coef_sort.values,y=coef_sort.index)
plt.show()
```
![image](https://github.com/user-attachments/assets/26b50fc9-9716-4b7f-8d78-ece346e4004c)

![image](https://github.com/user-attachments/assets/048ece8c-fbcb-4847-9867-6d05fa2c40eb)

```
columns=[
    'year'
    ,'month'
    ,'day'
    ,'hour'
    ,'holiday'
    ,'workingday'
    ,'season'
    ,'weather'
]
X_features_ohe=pd.get_dummies(
    X_features
    ,columns=columns
)

# ì›-í•« ì¸ì½”ë”©ì´ ì ìš©ëœ í”¼ì³ ë°ì´í„° ì„¸íŠ¸ ê¸°ë°˜ìœ¼ë¡œ í•™ìŠµ/ì˜ˆì¸¡ ë°ì´í„° ë¶„í• 
X_train_ohe,X_test_ohe,y_train_ohe,y_test_ohe=train_test_split(
    X_features_ohe
    ,y_target_log
    # ,y_target
    ,test_size=0.3
    ,random_state=0
)

# ëª¨ë¸ê³¼ í•™ìŠµ/í…ŒìŠ¤íŠ¸ ë°ì´í„° ì„¸íŠ¸ë¥¼ ì…ë ¥í•˜ë©´ ì„±ëŠ¥ í‰ê°€ ìˆ˜ì¹˜ë¥¼ ë°˜í™˜
def get_model_predcit(model,X_train,X_test,y_train,y_test,is_expm1=False):
    model.fit(X_train,y_train)
    pred=model.predict(X_test)
    if is_expm1 :
        y_test=np.expm1(y_test)
        pred=np.expm1(pred)
    print('**',model.__class__.__name__,'**')
    evaluate_regr(y_test,pred)
```
```
# ëª¨ë¸ë³„ë¡œ í‰ê°€ ìˆ˜í–‰
lr_reg=LinearRegression()
ridge_reg=Ridge(alpha=10)
lasso_reg=Lasso(alpha=0.01)

for model in [lr_reg,ridge_reg,lasso_reg]:
    get_model_predcit(model,X_train_ohe,X_test_ohe,y_train_ohe,y_test_ohe,is_expm1=True)
```
![image](https://github.com/user-attachments/assets/045ccf03-ecfe-45cd-b219-626b66ebd7c7)

```
ridge_results = []
lasso_results = []

for alpha in range(0, 101):
    ridge = Ridge(alpha=alpha)
    lasso = Lasso(alpha=alpha)
    print('='*50)
    print(f'alpha : {alpha}')
    ridge_score = get_model_predcit(ridge, X_train_ohe, X_test_ohe, y_train_ohe, y_test_ohe, is_expm1=True)
    ridge_results.append((alpha, ridge_score))
    lasso_score = get_model_predcit(lasso, X_train_ohe, X_test_ohe, y_train_ohe, y_test_ohe, is_expm1=True)
    lasso_results.append((alpha, lasso_score))
```
```
==================================================
alpha : 0
** Ridge **
RMSLE : 0.5897205420392388, RMSE : 97.74615407060202, MAE : 63.41463728222294
c:\ProgramData\anaconda3\envs\pyml\lib\site-packages\sklearn\base.py:1389: UserWarning: With alpha=0, this algorithm does not converge well. You are advised to use the LinearRegression estimator
  return fit_method(estimator, *args, **kwargs)
c:\ProgramData\anaconda3\envs\pyml\lib\site-packages\sklearn\linear_model\_coordinate_descent.py:695: UserWarning: Coordinate descent with no regularization may lead to unexpected results and is discouraged.
  model = cd_fast.enet_coordinate_descent(
c:\ProgramData\anaconda3\envs\pyml\lib\site-packages\sklearn\linear_model\_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 1.269e+03, tolerance: 1.533e+00 Linear regression models with null weight for the l1 regularization term are more efficiently fitted using one of the solvers implemented in sklearn.linear_model.Ridge/RidgeCV instead.
  model = cd_fast.enet_coordinate_descent(
** Lasso **
RMSLE : 0.5896337332621217, RMSE : 97.68764291861575, MAE : 63.3820293225802
==================================================
alpha : 1
** Ridge **
RMSLE : 0.5895391663007115, RMSE : 97.74495351657619, MAE : 63.41631036217564
** Lasso **
RMSLE : 1.2398677584264723, RMSE : 177.7215780384234, MAE : 121.34240923835165
==================================================
alpha : 2
** Ridge **
RMSLE : 0.5894798906293434, RMSE : 97.80931309845754, MAE : 63.45839692012418
** Lasso **
RMSLE : 1.2616771316398145, RMSE : 183.29369908873377, MAE : 125.39300706992786
==================================================
alpha : 3
** Ridge **
RMSLE : 0.5894544295122993, RMSE : 97.88014952954447, MAE : 63.502812047270176
** Lasso **
RMSLE : 1.295883458776995, RMSE : 189.71202561460166, MAE : 130.68393395234173
==================================================
alpha : 4
** Ridge **
RMSLE : 0.5894616580631327, RMSE : 97.95706875065177, MAE : 63.55262000586692
** Lasso **
RMSLE : 1.3415387911647612, RMSE : 196.13666619984485, MAE : 136.61692178183748
==================================================
alpha : 5
** Ridge **
RMSLE : 0.5895005473768302, RMSE : 98.03972670487778, MAE : 63.6049208745368
** Lasso **
RMSLE : 1.3653161556875035, RMSE : 199.1449022060153, MAE : 139.4981048966547
==================================================
alpha : 6
** Ridge **
RMSLE : 0.5895701177887919, RMSE : 98.12780561946691, MAE : 63.659574525102265
** Lasso **
RMSLE : 1.3767773419524314, RMSE : 200.60666321893865, MAE : 140.84215167329535
==================================================
alpha : 7
** Ridge **
RMSLE : 0.5896694252889318, RMSE : 98.22100685560221, MAE : 63.71579899084953
** Lasso **
RMSLE : 1.3900691241712406, RMSE : 202.07148240444158, MAE : 142.23698768032156
==================================================
alpha : 8
** Ridge **
RMSLE : 0.58979755620002, RMSE : 98.31904790729298, MAE : 63.77361407344683
** Lasso **
RMSLE : 1.4051395542660867, RMSE : 203.53120444276328, MAE : 143.70295641209844
==================================================
alpha : 9
** Ridge **
RMSLE : 0.5899536245279065, RMSE : 98.4216607580703, MAE : 63.83315287456023
** Lasso **
RMSLE : 1.421932080051749, RMSE : 204.98385891804938, MAE : 145.2268593727445
==================================================
alpha : 10
** Ridge **
RMSLE : 0.5901367703437248, RMSE : 98.52859077604568, MAE : 63.893352771107956
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 11
** Ridge **
RMSLE : 0.5903461586228118, RMSE : 98.63959585907236, MAE : 63.953913151821624
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 12
** Ridge **
RMSLE : 0.5905809783102909, RMSE : 98.75444571401465, MAE : 64.01722622165853
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 13
** Ridge **
RMSLE : 0.5908404415114955, RMSE : 98.87292121815118, MAE : 64.08253982558197
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 14
** Ridge **
RMSLE : 0.5911237827583044, RMSE : 98.99481383718066, MAE : 64.14990345035547
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 15
** Ridge **
RMSLE : 0.5914302583262069, RMSE : 99.11992508618647, MAE : 64.21919925734996
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 16
** Ridge **
RMSLE : 0.5917591455883223, RMSE : 99.24806602565803, MAE : 64.29079406607363
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 17
** Ridge **
RMSLE : 0.5921097423984077, RMSE : 99.37905678761143, MAE : 64.36403966032087
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 18
** Ridge **
RMSLE : 0.5924813664980094, RMSE : 99.51272612845145, MAE : 64.43943941694297
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 19
** Ridge **
RMSLE : 0.5928733549446464, RMSE : 99.64891100612805, MAE : 64.51618936938151
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 20
** Ridge **
RMSLE : 0.5932850635589288, RMSE : 99.7874561796885, MAE : 64.59258828732885
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 21
** Ridge **
RMSLE : 0.5937158663891251, RMSE : 99.92821382967186, MAE : 64.6687720572302
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 22
** Ridge **
RMSLE : 0.594165155192066, RMSE : 100.07104319802134, MAE : 64.74583767392367
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 23
** Ridge **
RMSLE : 0.5946323389295223, RMSE : 100.21581024635059, MAE : 64.82526481152813
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 24
** Ridge **
RMSLE : 0.5951168432793456, RMSE : 100.36238733151696, MAE : 64.90607649933403
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 25
** Ridge **
RMSLE : 0.5956181101607799, RMSE : 100.51065289754644, MAE : 64.98832731517588
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 26
** Ridge **
RMSLE : 0.5961355972734181, RMSE : 100.66049118302672, MAE : 65.0705505236338
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 27
** Ridge **
RMSLE : 0.5966687776493418, RMSE : 100.81179194314709, MAE : 65.15271211889684
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 28
** Ridge **
RMSLE : 0.5972171392180144, RMSE : 100.9644501856146, MAE : 65.23495244963203
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 29
** Ridge **
RMSLE : 0.5977801843835377, RMSE : 101.11836591972555, MAE : 65.31769540244389
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 30
** Ridge **
RMSLE : 0.5983574296138979, RMSE : 101.27344391790827, MAE : 65.4013087547472
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 31
** Ridge **
RMSLE : 0.598948405041853, RMSE : 101.4295934890964, MAE : 65.48511387901182
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 32
** Ridge **
RMSLE : 0.5995526540771278, RMSE : 101.58672826332347, MAE : 65.56931446663843
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 33
** Ridge **
RMSLE : 0.6001697330295948, RMSE : 101.74476598696364, MAE : 65.6534460938397
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 34
** Ridge **
RMSLE : 0.6007992107431342, RMSE : 101.90362832807419, MAE : 65.73783926954303
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 35
** Ridge **
RMSLE : 0.6014406682398772, RMSE : 102.06324069132303, MAE : 65.82377722194441
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 36
** Ridge **
RMSLE : 0.6020936983745403, RMSE : 102.22353204201333, MAE : 65.91092580822102
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 37
** Ridge **
RMSLE : 0.6027579054985787, RMSE : 102.38443473874038, MAE : 65.99881282357894
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 38
** Ridge **
RMSLE : 0.6034329051338821, RMSE : 102.54588437424263, MAE : 66.08650912548822
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 39
** Ridge **
RMSLE : 0.6041183236557539, RMSE : 102.70781962402947, MAE : 66.17449283656009
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 40
** Ridge **
RMSLE : 0.6048137979849177, RMSE : 102.87018210239127, MAE : 66.26307600566655
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 41
** Ridge **
RMSLE : 0.6055189752883011, RMSE : 103.03291622541725, MAE : 66.35197311732492
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 42
** Ridge **
RMSLE : 0.6062335126883555, RMSE : 103.19596908066522, MAE : 66.44249805952214
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 43
** Ridge **
RMSLE : 0.606957076980678, RMSE : 103.35929030314838, MAE : 66.53325600786177
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 44
** Ridge **
RMSLE : 0.6076893443597035, RMSE : 103.52283195731806, MAE : 66.62365608418371
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 45
** Ridge **
RMSLE : 0.6084300001522434, RMSE : 103.68654842474079, MAE : 66.71435162185928
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 46
** Ridge **
RMSLE : 0.6091787385586559, RMSE : 103.8503962971826, MAE : 66.80539209226767
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 47
** Ridge **
RMSLE : 0.609935262401432, RMSE : 104.0143342748282, MAE : 66.89609592065618
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 48
** Ridge **
RMSLE : 0.6106992828809937, RMSE : 104.17832306937707, MAE : 66.98755103910048
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 49
** Ridge **
RMSLE : 0.6114705193384996, RMSE : 104.34232531177217, MAE : 67.07898112098582
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 50
** Ridge **
RMSLE : 0.6122486990254646, RMSE : 104.50630546432866, MAE : 67.16958911066331
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 51
** Ridge **
RMSLE : 0.6130335568799996, RMSE : 104.6702297370429, MAE : 67.2608505295047
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 52
** Ridge **
RMSLE : 0.6138248353094884, RMSE : 104.83406600787379, MAE : 67.35267102478998
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 53
** Ridge **
RMSLE : 0.6146222839795155, RMSE : 104.99778374679734, MAE : 67.44514969742377
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 54
** Ridge **
RMSLE : 0.6154256596088719, RMSE : 105.16135394344784, MAE : 67.53725999956009
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 55
** Ridge **
RMSLE : 0.6162347257704652, RMSE : 105.3247490381678, MAE : 67.6292015436983
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 56
** Ridge **
RMSLE : 0.6170492526979658, RMSE : 105.4879428562968, MAE : 67.7213681265364
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 57
** Ridge **
RMSLE : 0.617869017098026, RMSE : 105.65091054554087, MAE : 67.81367272338221
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 58
** Ridge **
RMSLE : 0.6186938019679136, RMSE : 105.81362851626899, MAE : 67.90610261719307
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 59
** Ridge **
RMSLE : 0.6195233964184056, RMSE : 105.9760743845937, MAE : 67.99808461228412
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 60
** Ridge **
RMSLE : 0.620357595501789, RMSE : 106.13822691809911, MAE : 68.08963362302848
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 61
** Ridge **
RMSLE : 0.6211962000448235, RMSE : 106.30006598408625, MAE : 68.1815397192192
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 62
** Ridge **
RMSLE : 0.6220390164865256, RMSE : 106.46157250021304, MAE : 68.27331875994768
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 63
** Ridge **
RMSLE : 0.6228858567206297, RMSE : 106.62272838741278, MAE : 68.3659002195763
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 64
** Ridge **
RMSLE : 0.6237365379425965, RMSE : 106.78351652497898, MAE : 68.45910200310321
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 65
** Ridge **
RMSLE : 0.6245908825010356, RMSE : 106.94392070771319, MAE : 68.55199789721966
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 66
** Ridge **
RMSLE : 0.6254487177534113, RMSE : 107.10392560503493, MAE : 68.64430898288111
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 67
** Ridge **
RMSLE : 0.6263098759259127, RMSE : 107.263516721959, MAE : 68.73588410149024
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 68
** Ridge **
RMSLE : 0.6271741939773634, RMSE : 107.42268036185165, MAE : 68.82726211793066
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 69
** Ridge **
RMSLE : 0.6280415134670542, RMSE : 107.58140359087788, MAE : 68.91889029897797
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 70
** Ridge **
RMSLE : 0.6289116804263843, RMSE : 107.73967420406179, MAE : 69.01116119677707
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 71
** Ridge **
RMSLE : 0.6297845452342026, RMSE : 107.8974806928802, MAE : 69.10416465220754
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 72
** Ridge **
RMSLE : 0.630659962495735, RMSE : 108.0548122143187, MAE : 69.19802176408218
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 73
** Ridge **
RMSLE : 0.6315377909250006, RMSE : 108.21165856131924, MAE : 69.29249125651718
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 74
** Ridge **
RMSLE : 0.6324178932306084, RMSE : 108.36801013455371, MAE : 69.38799593370751
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 75
** Ridge **
RMSLE : 0.6333001360048399, RMSE : 108.52385791546234, MAE : 69.48369346345496
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 76
** Ridge **
RMSLE : 0.6341843896159169, RMSE : 108.67919344049407, MAE : 69.57923055269146
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 77
** Ridge **
RMSLE : 0.6350705281033668, RMSE : 108.83400877649603, MAE : 69.67492509149444
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 78
** Ridge **
RMSLE : 0.6359584290763889, RMSE : 108.98829649719576, MAE : 69.77059651701319
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 79
** Ridge **
RMSLE : 0.6368479736151375, RMSE : 109.14204966072641, MAE : 69.86601761398674
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 80
** Ridge **
RMSLE : 0.6377390461748345, RMSE : 109.29526178814587, MAE : 69.96101748433841
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 81
** Ridge **
RMSLE : 0.638631534492628, RMSE : 109.44792684290354, MAE : 70.05596327314286
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 82
** Ridge **
RMSLE : 0.639525329497117, RMSE : 109.60003921121111, MAE : 70.15056064305126
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 83
** Ridge **
RMSLE : 0.6404203252204647, RMSE : 109.75159368327543, MAE : 70.24489954222071
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 84
** Ridge **
RMSLE : 0.6413164187130204, RMSE : 109.90258543535373, MAE : 70.338700670765
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 85
** Ridge **
RMSLE : 0.6422135099603821, RMSE : 110.05301001259365, MAE : 70.43181268337226
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 86
** Ridge **
RMSLE : 0.6431115018028226, RMSE : 110.20286331262133, MAE : 70.5241971630301
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 87
** Ridge **
RMSLE : 0.6440102998570124, RMSE : 110.35214156984496, MAE : 70.6159291277477
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 88
** Ridge **
RMSLE : 0.6449098124399711, RMSE : 110.50084134043883, MAE : 70.70704031346864
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 89
** Ridge **
RMSLE : 0.6458099504951815, RMSE : 110.64895948797962, MAE : 70.79858114395626
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 90
** Ridge **
RMSLE : 0.6467106275208033, RMSE : 110.796493169703, MAE : 70.88990903174944
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 91
** Ridge **
RMSLE : 0.6476117594999244, RMSE : 110.94343982335432, MAE : 70.98084065009965
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 92
** Ridge **
RMSLE : 0.6485132648327894, RMSE : 111.08979715460495, MAE : 71.07114825295322
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 93
** Ridge **
RMSLE : 0.6494150642709473, RMSE : 111.23556312501105, MAE : 71.16169332140505
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 94
** Ridge **
RMSLE : 0.6503170808532631, RMSE : 111.38073594048755, MAE : 71.25196382402495
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 95
** Ridge **
RMSLE : 0.6512192398437371, RMSE : 111.52531404027721, MAE : 71.34194352123617
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 96
** Ridge **
RMSLE : 0.6521214686710785, RMSE : 111.66929608639067, MAE : 71.43165797601604
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 97
** Ridge **
RMSLE : 0.6530236968699842, RMSE : 111.8126809534974, MAE : 71.52125950764318
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 98
** Ridge **
RMSLE : 0.6539258560240695, RMSE : 111.95546771924742, MAE : 71.61118521787391
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 99
** Ridge **
RMSLE : 0.6548278797104056, RMSE : 112.09765565500481, MAE : 71.70169286030894
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
==================================================
alpha : 100
** Ridge **
RMSLE : 0.6557297034456123, RMSE : 112.2392442169747, MAE : 71.79165656920921
** Lasso **
RMSLE : 1.4220814456392863, RMSE : 204.99613442492955, MAE : 145.23988938387464
```
```
coef=pd.Series(lr_reg.coef_,index=X_features_ohe.columns)
coef_sort=coef.sort_values(ascending=False)[:25]
sns.barplot(x=coef_sort.values,y=coef_sort.index)
plt.show()
```
![image](https://github.com/user-attachments/assets/8773ae8a-ca33-4429-ac70-dfab28f2c081)

## ğŸ¯ ì›-í•« ì¸ì½”ë”© (One-hot Encoding)

ë²”ì£¼í˜• ë°ì´í„°ë¥¼ ë²¡í„°ë¡œ í‘œí˜„í•˜ëŠ” ëŒ€í‘œì ì¸ ë°©ë²• ì¤‘ í•˜ë‚˜ë¡œ, ê° ë²”ì£¼ë¥¼ ê³ ìœ í•œ **ì´ì§„ ë²¡í„°(binary vector)** ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

ì˜ˆ: ì„¸ ê°€ì§€ ë²”ì£¼ `'ê³ ì–‘ì´'`, `'ê°•ì•„ì§€'`, `'í† ë¼'`ê°€ ìˆì„ ë•Œ

- `'ê³ ì–‘ì´'` â†’ `[1, 0, 0]`  
- `'ê°•ì•„ì§€'` â†’ `[0, 1, 0]`  
- `'í† ë¼'` â†’ `[0, 0, 1]`


### âœ… ì¥ì  (Advantages)

- **ê°„ë‹¨í•˜ê³  ì§ê´€ì **
  - ì´í•´ì™€ êµ¬í˜„ì´ ë§¤ìš° ì‰¬ì›€
- **ë²”ì£¼ì˜ ìˆœì„œë¥¼ ê³ ë ¤í•˜ì§€ ì•ŠìŒ**
  - ì •ìˆ˜ ì¸ì½”ë”©ì²˜ëŸ¼ ì˜ëª»ëœ ìˆœìœ„ ì¶”ë¡ ì„ í•˜ì§€ ì•ŠìŒ
- **ëŒ€ë¶€ë¶„ì˜ ML ì•Œê³ ë¦¬ì¦˜ê³¼ í˜¸í™˜**
  - ë¡œì§€ìŠ¤í‹± íšŒê·€, SVM, ê²°ì • íŠ¸ë¦¬ ë“±ì—ì„œ ì˜ ì‘ë™

### âŒ ë‹¨ì  (Disadvantages)

- **ì°¨ì›ì˜ ì €ì£¼ (Curse of Dimensionality)**
  - ë²”ì£¼ ìˆ˜ê°€ ë§ìœ¼ë©´ ë²¡í„° ì°¨ì›ì´ ì»¤ì§ â†’ ì—°ì‚° ë¹„íš¨ìœ¨
- **í¬ì†Œ í–‰ë ¬(Sparse Matrix)**
  - ëŒ€ë¶€ë¶„ì˜ ê°’ì´ 0 â†’ ë©”ëª¨ë¦¬ ë‚­ë¹„ ë° ì„±ëŠ¥ ì €í•˜
- **ìœ ì‚¬ì„± ì •ë³´ ì†ì‹¤**
  - ë²”ì£¼ ê°„ ê´€ê³„ë‚˜ ìœ ì‚¬ì„±ì„ ë°˜ì˜í•˜ì§€ ëª»í•¨

### ğŸš€ ëŒ€ì•ˆ (Alternatives)

| ë°©ë²• | ì„¤ëª… |
|------|------|
| **ì„ë² ë”© (Embedding)** | ë°€ì§‘(dense) ë²¡í„°ë¡œ í‘œí˜„ â†’ ì°¨ì› ì¶•ì†Œ + ì˜ë¯¸ ë³´ì¡´ (íŠ¹íˆ ë”¥ëŸ¬ë‹ì—ì„œ ìœ ìš©) |
| **ë¹ˆë„ ê¸°ë°˜ ì¸ì½”ë”©** | ë²”ì£¼ì˜ ë“±ì¥ ë¹ˆë„ë‚˜ ì¹´ìš´íŠ¸ë¥¼ ìˆ˜ì¹˜ë¡œ ëŒ€ì²´ |
| **íƒ€ê²Ÿ ì¸ì½”ë”©** | ë²”ì£¼ë³„ í‰ê·  íƒ€ê²Ÿê°’ì„ ë¶€ì—¬ (ì£¼ì˜: ë°ì´í„° ëˆ„ìˆ˜ ê°€ëŠ¥) |

### ğŸ“Œ ìš”ì•½

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì‚¬ìš© ëª©ì  | ë²”ì£¼í˜• ë°ì´í„°ì˜ ìˆ˜ì¹˜ í‘œí˜„ |
| ì¥ì  | ë‹¨ìˆœí•¨, ìˆœìœ„ ì™œê³¡ ì—†ìŒ |
| ë‹¨ì  | ì°¨ì› ì¦ê°€, ìœ ì‚¬ì„± í‘œí˜„ ë¶ˆê°€ |
| ëŒ€í‘œ ëŒ€ì•ˆ | ì„ë² ë”©, ë¹ˆë„ ì¸ì½”ë”©, íƒ€ê²Ÿ ì¸ì½”ë”© ë“± |

```
# íšŒê·€ íŠ¸ë¦¬ ì„±ëŠ¥ í™•ì¸
from sklearn.ensemble import RandomForestRegressor, GradientBoostingRegressor
from xgboost import XGBRegressor
from lightgbm import LGBMRegressor

# ëœë¤ í¬ë ˆìŠ¤íŠ¸, GBM, XGBoost, LightGBM model ë³„ë¡œ í‰ê°€ ìˆ˜í–‰
rf_reg=RandomForestRegressor(n_estimators=500)
gbm_reg=GradientBoostingRegressor(n_estimators=500)
xgb_reg=XGBRegressor(n_estimators=500,tree_method='gpu_hist', predictor='gpu_predictor')
lgbm_reg=LGBMRegressor(n_estimators=500,device='gpu')

for model in [rf_reg,gbm_reg,xgb_reg,lgbm_reg]:
    get_model_predcit(model,X_train.values,X_test.values,y_train.values,y_test.values,is_expm1=False)
print('='*100)
for model in [rf_reg,gbm_reg,xgb_reg,lgbm_reg]:
    get_model_predcit(model,X_train_ohe.values,X_test_ohe.values,y_train_ohe.values,y_test_ohe.values,is_expm1=True)
```
![image](https://github.com/user-attachments/assets/f3d2c049-45e3-4072-8f92-bec63493eefc)

---
### ì •ë¦¬
ìì „ê±° ëŒ€ì—¬ ìˆ˜ìš”ë¥¼ ì˜ˆì¸¡í•˜ë ¤ë©´ ì‹œê³„ì—´ ë°ì´í„°ì˜ íŠ¹ì„±ì„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ìœ„ì—ì„œëŠ” ì‹œê³„ì—´ ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ì§€ ì•Šê³  ë‹¨ìˆœíˆ train_test_splitì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë¶„í• í–ˆê¸° ë•Œë¬¸ì—, ì‹¤ì œ ì‹œê³„ì—´ ì˜ˆì¸¡ ìƒí™©ê³¼ëŠ” ë§ì§€ ì•ŠëŠ” ë°©ì‹ì…ë‹ˆë‹¤.
ì´ëŠ” ì‹œê³„ì—´ ë¶„ì„ë³´ë‹¤ëŠ” íšŒê·€ ëª¨ë¸ì˜ ê¸°ë³¸ì ì¸ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì˜ˆì‹œë¡œ ë³´ì•„ì•¼ í•˜ë©°, ì‹¤ì œ ì˜ˆì¸¡ ëª¨ë¸ì„ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” ì‹œê³„ì—´ ë°ì´í„° ì „ì²˜ë¦¬ ë° ì‹œê³„ì—´ì— ì í•©í•œ ëª¨ë¸ë§ ì ‘ê·¼ì´ í•„ìš”í•©ë‹ˆë‹¤.

#### ì‹œê³„ì—´ ë°ì´í„° ë¶„ì„ì˜ ë¶„í•  ë° ëª¨ë¸ë§ ë°©ë²•

##### ë°ì´í„° ë¶„í•  ë°©ì‹ì˜ í•œê³„ì 

- ì¼ë°˜ì ì¸ `train_test_split` ë°©ì‹ì€ ì‹œê³„ì—´ ë°ì´í„°(ì–¸ì–´ ëª¨ë¸, ì£¼ì‹ ë°ì´í„° ë“±) ë¶„ì„ì— ë¹„íš¨ìœ¨ì ì…ë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

* **ìˆœì°¨ì  íŠ¹ì„± ë¬´ì‹œ:** ë¬´ì‘ìœ„ ë¶„í• ì€ ì‹œê³„ì—´ ë°ì´í„°ì˜ í•µì‹¬ì¸ ì‹œê°„ ìˆœì„œì— ë”°ë¥¸ ì˜ì¡´ì„±ì„ ê³ ë ¤í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
* **ë°ì´í„° ëˆ„ìˆ˜(Data Leakage):** ë¯¸ë˜ ì‹œì ì˜ ë°ì´í„°ê°€ í•™ìŠµì— ì‚¬ìš©ë˜ê³ , ê³¼ê±° ì‹œì ì˜ ë°ì´í„°ë¡œ í…ŒìŠ¤íŠ¸ë˜ëŠ” ìƒí™©ì´ ë°œìƒí•˜ì—¬ ëª¨ë¸ ì„±ëŠ¥ì„ ê³¼ëŒ€í‰ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

##### RNN(Recurrent Neural Network)ì˜ íŠ¹ì„±

- RNNì€ ì‹œê³„ì—´ ë°ì´í„° ì²˜ë¦¬ì— ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì§•ì„ ê°€ì§‘ë‹ˆë‹¤.

* **ìˆœì°¨ì  ë°ì´í„° ì²˜ë¦¬:** ì´ì „ ì‹œì ì˜ ì •ë³´ë¥¼ ë‹¤ìŒ ì‹œì ì— ìˆœì°¨ì ìœ¼ë¡œ ì „ë‹¬í•˜ë©° ì²˜ë¦¬í•©ë‹ˆë‹¤.
* **ì‹œê°„ì  ì˜ì¡´ì„± ëª¨ë¸ë§:** ìˆœì„œê°€ ì¤‘ìš”í•œ ë°ì´í„°ì˜ ì‹œê°„ì ì¸ ì˜ì¡´ì„±ì„ íš¨ê³¼ì ìœ¼ë¡œ ëª¨ë¸ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ë³‘ë ¬ ì²˜ë¦¬ì˜ í•œê³„:** ìˆœì°¨ì ì¸ ê³„ì‚° ë°©ì‹ìœ¼ë¡œ ì¸í•´ ë°ì´í„° ë³‘ë ¬ ì²˜ë¦¬ì— ì–´ë ¤ì›€ì´ ìˆìŠµë‹ˆë‹¤.
* **ìì—°ì–´ ì²˜ë¦¬ íš¨ìœ¨ì„± ë¬¸ì œ:** ê¸´ ì‹œí€€ìŠ¤ ë°ì´í„°ì—ì„œ ê¸°ìš¸ê¸° ì†Œì‹¤/í­ë°œ ë¬¸ì œë¡œ ì¸í•´ ì •ë³´ ì†ì‹¤ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

##### Transformerì˜ ë°œì „ëœ ê¸°ëŠ¥

- Transformer ëª¨ë¸ì€ RNNì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ë©° ë‹¤ìŒê³¼ ê°™ì€ ë°œì „ëœ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

* **ë³‘ë ¬ ì²˜ë¦¬ ê°€ëŠ¥:** ìê¸° ì£¼ì˜(self-attention) ë©”ì»¤ë‹ˆì¦˜ì„ í†µí•´ ì…ë ¥ í† í° ì „ì²´ë¥¼ ë™ì‹œì— ì²˜ë¦¬í•˜ì—¬ ë³‘ë ¬ ì—°ì‚°ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
* **ì¥ê±°ë¦¬ ì˜ì¡´ì„± í¬ì°©:** ì‹œí€€ìŠ¤ ë‚´ì˜ ëª¨ë“  ìœ„ì¹˜ ê°„ì˜ ê´€ê³„ë¥¼ ì§ì ‘ì ìœ¼ë¡œ ëª¨ë¸ë§í•˜ì—¬ ì¥ê±°ë¦¬ ì˜ì¡´ì„±ì„ íš¨ê³¼ì ìœ¼ë¡œ íŒŒì•…í•©ë‹ˆë‹¤.
* **ê³„ì‚° íš¨ìœ¨ì„±:** ë³‘ë ¬ ì²˜ë¦¬ ëŠ¥ë ¥ ë•ë¶„ì— í•™ìŠµ ë° ì¶”ë¡  ì†ë„ê°€ í¬ê²Œ í–¥ìƒë©ë‹ˆë‹¤.
* **í™•ì¥ì„±:** ë” ê¹Šì€ ëª¨ë¸ êµ¬ì¡°ì™€ ëŒ€ê·œëª¨ ë°ì´í„°ì…‹ì— íš¨ê³¼ì ìœ¼ë¡œ ì ìš©í•  ìˆ˜ ìˆëŠ” í™•ì¥ì„±ì„ ê°€ì§‘ë‹ˆë‹¤.

##### ì‹œê³„ì—´ ë°ì´í„°ì— ì í•©í•œ ë¶„í•  ë°©ë²•

- ì‹œê³„ì—´ ë°ì´í„° ë¶„ì„ì—ì„œëŠ” ë°ì´í„°ì˜ ìˆœì°¨ì  íŠ¹ì„±ì„ ê³ ë ¤í•œ ë¶„í•  ë°©ë²•ì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤. ì¼ë°˜ì ì¸ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

* **ì‹œê°„ ê¸°ë°˜ ë¶„í• :** íŠ¹ì • ì‹œì ì„ ê¸°ì¤€ìœ¼ë¡œ ì´ì „ ë°ì´í„°ë¥¼ í•™ìŠµ ì„¸íŠ¸ë¡œ, ì´í›„ ë°ì´í„°ë¥¼ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë¶„í• í•©ë‹ˆë‹¤. ì´ëŠ” ë¯¸ë˜ ì •ë³´ë¥¼ í•™ìŠµì— ì‚¬ìš©í•˜ì§€ ì•Šì•„ ë°ì´í„° ëˆ„ìˆ˜ ë¬¸ì œë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.
* **ì‹œê°„ ì°½ ê¸°ë²•(Time Window):** ê³¼ê±°ì˜ ì¼ì • ê¸°ê°„ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¯¸ë˜ì˜ íŠ¹ì • ì‹œì ì„ ì˜ˆì¸¡í•©ë‹ˆë‹¤. í•™ìŠµ ë°ì´í„°ë¥¼ ìŠ¬ë¼ì´ë”© ìœˆë„ìš° ë°©ì‹ìœ¼ë¡œ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ì „ì§„ ê²€ì¦(Forward Validation):** ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ í•™ìŠµ ì„¸íŠ¸ì˜ í¬ê¸°ë¥¼ ì ì§„ì ìœ¼ë¡œ í™•ì¥í•˜ë©´ì„œ ëª¨ë¸ì„ í‰ê°€í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì´ˆê¸° ëª‡ ê°œì›” ë°ì´í„°ë¥¼ í•™ìŠµí•˜ê³  ë‹¤ìŒ ë‹¬ì„ ê²€ì¦í•˜ëŠ” ê³¼ì •ì„ ë°˜ë³µí•©ë‹ˆë‹¤.

#### ê²°ë¡ 

- íš¨ê³¼ì ì¸ ì‹œê³„ì—´ ë°ì´í„° ì˜ˆì¸¡ ëª¨ë¸ êµ¬ì¶•ì„ ìœ„í•´ì„œëŠ” ì‹œê³„ì—´ ë°ì´í„°ì˜ íŠ¹ì„±ì„ ì •í™•íˆ ì´í•´í•˜ê³ , ì´ì— ë§ëŠ” ì ì ˆí•œ ë°ì´í„° ë¶„í•  ë°©ë²•ì„ ì„ íƒí•˜ëŠ” ê²ƒì´ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤. ë˜í•œ, ë¬¸ì œì˜ íŠ¹ì„±ê³¼ ë°ì´í„°ì˜ ê·œëª¨ì— ë”°ë¼ RNN ë˜ëŠ” Transformerì™€ ê°™ì€ ì í•©í•œ ëª¨ë¸ì„ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.
