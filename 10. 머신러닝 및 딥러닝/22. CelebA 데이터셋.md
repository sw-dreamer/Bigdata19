# CelebA 데이터셋

```
import torch
print(f"CUDA available: {torch.cuda.is_available()}")
print(f"PyTorch version: {torch.__version__}")
print(f"CUDA version: {torch.version.cuda if torch.cuda.is_available() else 'Not available'}")
```
```
CUDA available: True
PyTorch version: 2.7.0+cu118
CUDA version: 11.8
```
```
import torch
import torchvision
import numpy as np
import os

image_path = './celeba'

celeba_train_dataset = torchvision.datasets.CelebA(
    image_path,
    split='train',
    target_type='attr',
    download=True
)

celeba_valid_dataset = torchvision.datasets.CelebA(
    image_path,
    split='valid',
    target_type='attr',
    download=True
)

celeba_test_dataset = torchvision.datasets.CelebA(
    image_path,
    split='test',
    target_type='attr',
    download=True
)

print(f'훈련세트 : {len(celeba_train_dataset)}')
print(f'검증세트 : {len(celeba_valid_dataset)}')
print(f'테스트세트 : {len(celeba_test_dataset)}')
```
![image](https://github.com/user-attachments/assets/4ca601af-7d22-4397-9fbe-64dc1a3b39d3)

```
from torchvision import transforms
import matplotlib.pyplot as plt


## 다섯 개 샘플


fig = plt.figure(figsize=(16, 8.5))


## 1열: 바운딩 박스로 자르기
ax = fig.add_subplot(2, 5, 1)
img, attr = celeba_train_dataset[0]
ax.set_title('Crop to a \nbounding-box', size=15)
ax.imshow(img)
ax = fig.add_subplot(2, 5, 6)
img_cropped = transforms.functional.crop(img, 50, 20, 128, 128)
ax.imshow(img_cropped)


plt.show()
```
![image](https://github.com/user-attachments/assets/3db31936-8641-47fa-bacc-e9ef8d6c8bad)

```
import matplotlib.pyplot as plt
import torchvision.transforms as transforms

# 데이터셋에서 이미지를 불러옵니다.
img, attr = celeba_train_dataset[1]

# 새로운 figure 객체를 생성합니다.
fig = plt.figure(figsize=(10, 6))

# 첫 번째 서브플롯: 원본 이미지
ax = fig.add_subplot(2, 5, 2)
ax.set_title('Original Image', size=15)
ax.imshow(img)

# 두 번째 서브플롯: 수평 뒤집기한 이미지
ax = fig.add_subplot(2, 5, 7)
img_flipped = transforms.functional.hflip(img)
ax.set_title('Flip (horizontal)', size=15)
ax.imshow(img_flipped)

plt.show()
```
![image](https://github.com/user-attachments/assets/782d5f6e-f6bd-4bbe-b660-afbd14ef1ce2)
