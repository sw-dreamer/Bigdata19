# 좋은 훈련 데이터셋 만들기: 데이터 전처리

```
import pandas as pd
import numpy as np
from io import StringIO
csv_data=\
    '''
    A,B,C,D
    1.0,2.0,3.0,4.0
    5.0,6.0,,8.0
    10.0,11.0,12.0,
    '''
    
df=pd.read_csv(StringIO(csv_data))

df
```

![image](https://github.com/user-attachments/assets/23ef7c0a-79a2-4e5b-b68f-62aeb78078e7)

```
import pandas as pd
import numpy as np
from io import StringIO
csv_data=\
    '''
    A,B,C,D
    1.0,2.0,3.0,4.0
    5.0,6.0,,8.0
    10.0,11.0,12.0,
    '''
    
df=pd.read_csv(StringIO(csv_data))

df.isnull().sum()
```
![image](https://github.com/user-attachments/assets/ae6db08a-b8c7-4153-aabe-d88a367b058c)

```
import pandas as pd
import numpy as np
from io import StringIO
csv_data=\
    '''
    A,B,C,D
    1.0,2.0,3.0,4.0
    5.0,6.0,,8.0
    10.0,11.0,12.0,
    '''
    
df=pd.read_csv(StringIO(csv_data))

# 누락된 값이 있는 훈련 샘플이나 특성 제외
df.dropna(axis=0)
```
![image](https://github.com/user-attachments/assets/a27ee251-507d-46df-a439-405f2cfb550d)

```
import pandas as pd
import numpy as np
from io import StringIO
csv_data=\
    '''
    A,B,C,D
    1.0,2.0,3.0,4.0
    5.0,6.0,,8.0
    10.0,11.0,12.0,
    '''
    
df=pd.read_csv(StringIO(csv_data))

# 누락된 값이 있는 훈련 샘플이나 특성 제외
df.dropna(axis=1)
```
![image](https://github.com/user-attachments/assets/f6c3f9c7-65fe-4184-9b9d-89982c109ac0)

```
import pandas as pd
import numpy as np
from io import StringIO
csv_data=\
    '''
    A,B,C,D
    1.0,2.0,3.0,4.0
    5.0,6.0,,8.0
    10.0,11.0,12.0,
    '''
    
df=pd.read_csv(StringIO(csv_data))

df.dropna(axis=0,how='all')
```
![image](https://github.com/user-attachments/assets/b1b5c67c-601a-43ca-ac4e-73ccd913cd61)

```
import pandas as pd
import numpy as np
from io import StringIO
csv_data=\
    '''
    A,B,C,D
    1.0,2.0,3.0,4.0
    5.0,6.0,,8.0
    10.0,11.0,12.0,
    '''
    
df=pd.read_csv(StringIO(csv_data))

# 누락된 값 대체: SimpleImputer 사용
from sklearn.impute import SimpleImputer

imr =SimpleImputer(missing_values=np.nan,strategy='mean')
imr = imr.fit(df.values)
imputed_data=imr.transform(df.values)
imputed_data
```
![image](https://github.com/user-attachments/assets/c6f88be8-e8dd-461f-b1f6-18d85dcf0fa1)

```
import pandas as pd
import numpy as np
from io import StringIO
csv_data=\
    '''
    A,B,C,D
    1.0,2.0,3.0,4.0
    5.0,6.0,,8.0
    10.0,11.0,12.0,
    '''
    
df=pd.read_csv(StringIO(csv_data))

# 누락된 값 대체: SimpleImputer 사용
from sklearn.impute import SimpleImputer

imr =SimpleImputer()
imr = imr.fit(df.values)

# 컬럼별로 위 평균갑으로 대체
imputed_data=imr.transform(df.values)
imputed_data
```
![image](https://github.com/user-attachments/assets/9f5894f2-fba7-41b0-9749-38f54ccfb733)

```
import pandas as pd
import numpy as np
from io import StringIO
csv_data=\
    '''
    A,B,C,D
    1.0,2.0,3.0,4.0
    5.0,6.0,,8.0
    10.0,11.0,12.0,
    '''
    
df=pd.read_csv(StringIO(csv_data))

# 누락된 값 대체
from sklearn.impute import SimpleImputer

imr =SimpleImputer()
imr = imr.fit(df.values)

# SimpleImputer는 컬럼별로만 처리 가능
# FunctionTransformer 는 행별 처리가능
from sklearn.preprocessing import FunctionTransformer
ftr_imr=FunctionTransformer(
    lambda X:imr.fit_transform(X.T).T
    ,validate=False
)
imput_data=ftr_imr.fit_transform(df.values)
imput_data
```
![image](https://github.com/user-attachments/assets/80c1526f-cc3c-4f82-af6a-2753c9a4ef8c)
