# 데이터 분리

---
## 데이터셋을 훈련 데이터셋과 테스트 데이터셋으로 나누기

```
import pandas as pd
import numpy as np

df_wine = pd.read_csv('https://archive.ics.uci.edu/'
                      'ml/machine-learning-databases/wine/wine.data',
                      header=None)

# UCI 머신러닝 저장소의 Wine 데이터셋에 접근되지 않을 때
# 다음 코드의 주석을 제거하고 로컬 경로에서 데이터셋을 읽으세요:

# df_wine = pd.read_csv('wine.data', header=None)


df_wine.columns = ['Class label', 'Alcohol', 'Malic acid', 'Ash',
                   'Alcalinity of ash', 'Magnesium', 'Total phenols',
                   'Flavanoids', 'Nonflavanoid phenols', 'Proanthocyanins',
                   'Color intensity', 'Hue', 'OD280/OD315 of diluted wines',
                   'Proline']

print('Class labels', np.unique(df_wine['Class label']))
df_wine.head()
```
![image](https://github.com/user-attachments/assets/24c5beed-dfb8-43a4-91e4-ccc4f53d7129)

```
import pandas as pd
import numpy as np

df_wine = pd.read_csv('https://archive.ics.uci.edu/'
                      'ml/machine-learning-databases/wine/wine.data',
                      header=None)

df_wine.columns = ['Class label', 'Alcohol', 'Malic acid', 'Ash',
                   'Alcalinity of ash', 'Magnesium', 'Total phenols',
                   'Flavanoids', 'Nonflavanoid phenols', 'Proanthocyanins',
                   'Color intensity', 'Hue', 'OD280/OD315 of diluted wines',
                   'Proline']

df_wine.info()
```
![image](https://github.com/user-attachments/assets/fb9406ee-5539-4fdc-8c66-376035441246)

```
import pandas as pd
import numpy as np

df_wine = pd.read_csv('https://archive.ics.uci.edu/'
                      'ml/machine-learning-databases/wine/wine.data',
                      header=None)

df_wine.columns = ['Class label', 'Alcohol', 'Malic acid', 'Ash',
                   'Alcalinity of ash', 'Magnesium', 'Total phenols',
                   'Flavanoids', 'Nonflavanoid phenols', 'Proanthocyanins',
                   'Color intensity', 'Hue', 'OD280/OD315 of diluted wines',
                   'Proline']

df_wine.describe()
```
![image](https://github.com/user-attachments/assets/0ffab463-f4fa-4ec0-9b70-7892beef6b11)

```
import pandas as pd
import numpy as np

df_wine = pd.read_csv('https://archive.ics.uci.edu/'
                      'ml/machine-learning-databases/wine/wine.data',
                      header=None)

df_wine.columns = ['Class label', 'Alcohol', 'Malic acid', 'Ash',
                   'Alcalinity of ash', 'Magnesium', 'Total phenols',
                   'Flavanoids', 'Nonflavanoid phenols', 'Proanthocyanins',
                   'Color intensity', 'Hue', 'OD280/OD315 of diluted wines',
                   'Proline']

from sklearn.model_selection import train_test_split

# 데이터(X)와 답(y) 분리
X=df_wine.iloc[:,1:].values # 모든행, 1열부터 끝까지
y=df_wine.iloc[:,0].values # 레이블(답), 0열부터 끝까지

# 학습/테스트 데이터(답) 분리
X_train, X_test, y_train, y_test= train_test_split(
    X
    ,y
    ,test_size=0.3
    ,random_state=1
    ,stratify=y 
)
print(f'X_train.shape : {X_train.shape}')
print(f'X_test.shape : {X_test.shape}')
print(f'y_train.shape : {y_train.shape}')
print(f'y_test.shape : {y_test.shape}')
print('='*50)
print(f'np.bincount(y_train) : {np.bincount(y_train)}')
print(f'np.bincount(y_test) : {np.bincount(y_test)}')
```
![image](https://github.com/user-attachments/assets/7a09b08f-8b71-4b55-a668-8c171b12b69f)

```
import pandas as pd
import numpy as np

df_wine = pd.read_csv('https://archive.ics.uci.edu/'
                      'ml/machine-learning-databases/wine/wine.data',
                      header=None)

df_wine.columns = ['Class label', 'Alcohol', 'Malic acid', 'Ash',
                   'Alcalinity of ash', 'Magnesium', 'Total phenols',
                   'Flavanoids', 'Nonflavanoid phenols', 'Proanthocyanins',
                   'Color intensity', 'Hue', 'OD280/OD315 of diluted wines',
                   'Proline']

from sklearn.model_selection import train_test_split

# 데이터(X)와 답(y) 분리
X=df_wine.iloc[:,1:].values # 모든행, 1열부터 끝까지
y=df_wine.iloc[:,0].values # 레이블(답), 0열부터 끝까지

# 학습/테스트 데이터(답) 분리
X_train, X_test, y_train, y_test= train_test_split(
    X
    ,y
    ,test_size=0.3
    ,random_state=1
    ,stratify=y 
)

from sklearn.preprocessing import MinMaxScaler

mms=MinMaxScaler()

mms.fit(X_train) # 13개의 feature의 min/max 구해진다

X_train_norm=mms.transform(X_train)
X_test_norm=mms.transform(X_test)

X_train_norm.shape
```
![image](https://github.com/user-attachments/assets/fadc9b06-743e-41fe-9954-466428916af1)

```
import pandas as pd
import numpy as np

df_wine = pd.read_csv('https://archive.ics.uci.edu/'
                      'ml/machine-learning-databases/wine/wine.data',
                      header=None)

df_wine.columns = ['Class label', 'Alcohol', 'Malic acid', 'Ash',
                   'Alcalinity of ash', 'Magnesium', 'Total phenols',
                   'Flavanoids', 'Nonflavanoid phenols', 'Proanthocyanins',
                   'Color intensity', 'Hue', 'OD280/OD315 of diluted wines',
                   'Proline']

from sklearn.model_selection import train_test_split

# 데이터(X)와 답(y) 분리
X=df_wine.iloc[:,1:].values # 모든행, 1열부터 끝까지
y=df_wine.iloc[:,0].values # 레이블(답), 0열부터 끝까지

# 학습/테스트 데이터(답) 분리
X_train, X_test, y_train, y_test= train_test_split(
    X
    ,y
    ,test_size=0.3
    ,random_state=1
    ,stratify=y 
)

from sklearn.preprocessing import MinMaxScaler

mms=MinMaxScaler()

mms.fit(X_train) # 13개의 feature의 min/max 구해진다

X_train_norm=mms.transform(X_train)
X_test_norm=mms.transform(X_test)

print(f'X_train_norm.max() : {X_train_norm.max()}')
print(f'X_train_norm.min() : {X_train_norm.min()}')
```
![image](https://github.com/user-attachments/assets/c339efaf-ab46-44ab-84cf-49baa4e43af9)
