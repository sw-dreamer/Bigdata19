```
import numpy as np
import pandas as pd

import matplotlib.pyplot as plt
%matplotlib inline
import seaborn as sns

from scipy import stats

import warnings
warnings.filterwarnings('ignore')
```
```
# 보스톤 주택 가격(연속값) 예측(회귀모델)
# 데이터 로딩
boston_df=pd.read_csv(
    './boston_house_prices.csv'
    ,encoding='utf-8'
    ,header=1
)

boston_df.head()
```
![image](https://github.com/user-attachments/assets/7f014ca8-1bd8-4847-8c6f-65497276e7a5)

```
boston_df.info()
```
![image](https://github.com/user-attachments/assets/424e5e2e-0daf-492e-9cf8-4a6cef524c89)

```
boston_df.describe()
```
![image](https://github.com/user-attachments/assets/2fd74ec5-d3ec-45b1-a0e4-1f0ea629233d)

```
boston_df.columns
```
![image](https://github.com/user-attachments/assets/9e4c89a0-c924-4e24-aace-5e56273a5f31)

```
fig,axs=plt.subplots(
    figsize=(16,8)
    ,ncols=4
    ,nrows=2
)
lm_feautres=['RM','ZN','INDUS','NOX','AGE','PTRATIO','LSTAT','RAD']

for i, feature in enumerate(lm_feautres):
    row =int(i/4)
    col = i%4
    # 사본의 regplot을 이용해 산점도와 선형 회귀 직선을 함께 표현
    sns.regplot(
        x=feature
        ,y='MEDV'
        ,data=boston_df
        ,ax=axs[row][col]
    )
plt.show()
```
![image](https://github.com/user-attachments/assets/f748c32a-dbb7-4943-85e8-812366f72759)

```
# 2개의 행과 4개의 열을 가진 subplots를 이용. axs는 4x2개의 ax를 가짐.
fig, axs = plt.subplots(figsize=(16,8) , ncols=4 , nrows=2)
lm_features = ['RM','ZN','INDUS','NOX','AGE','PTRATIO','LSTAT','RAD']
for i , feature in enumerate(lm_features):
    row = int(i/4)
    col = i%4
    # 시본의 regplot을 이용해 산점도와 선형 회귀 직선을 함께 표현
    sns.regplot(x=feature , y='MEDV',data=boston_df , ax=axs[row][col])


# 이미지 파일 저장
fig1 = plt.gcf()
fig1.savefig('p322_boston.tif', format='tif', dpi=300, bbox_inches='tight')
```

```
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score

# 데이터 레이블 분리
y_target=boston_df['MEDV']
X_data=boston_df.drop(['MEDV'],axis=1,inplace=False)# False : 삭제한 DF를 반환

```

```
# 학습/테스트 데이터 분리
X_train,X_test,y_train,y_test=train_test_split(
    X_data
    ,y_target
    ,test_size=0.3
    ,random_state=0
)
```
```
# LinearRegression object create
lr =LinearRegression()
lr.fit(X_train,y_train) # 학습
y_pred=lr.predict(X_test) # 테스트 데이터로 예측값 출력

# 오차(원래답-예측값) : MSE
mse=mean_squared_error(y_test,y_pred)
rmse=np.sqrt(mse) # 제곱근
print(f'MSE : {mse}, RMSE : {rmse}')
print(f'Variance score : {r2_score(y_test,y_pred)}') # 모델의 설명력
```
![image](https://github.com/user-attachments/assets/d90e433c-923c-4b64-a35b-e53feece208b)

```
# 피쳐의 영향력 : 개수 값을 출력
print(f'회귀 계수 값 " {lr.coef_}')
```
![image](https://github.com/user-attachments/assets/3ff69b2f-cefb-412b-a984-8dbab38950ea)

```
coeff=pd.Series(
    data=np.round(lr.coef_,1)
    ,index=X_data.columns
)
coeff
```
![image](https://github.com/user-attachments/assets/e3023479-6964-46fc-ac79-ddfba815a9fa)

```
coeff=pd.Series(
    data=np.round(lr.coef_,1)
    ,index=X_data.columns
)
coeff.sort_values(ascending=False)
```
![image](https://github.com/user-attachments/assets/009b9f84-ccd0-405a-97d3-8ce1057e7645)

```
X_data.info()
```
![image](https://github.com/user-attachments/assets/9e6ed5f3-cf8c-4908-b400-9ff26eec2c76)

```
y_target.info()
```
![image](https://github.com/user-attachments/assets/69e1bcf0-b2c1-4acc-9b93-ac98dbc95dad)
