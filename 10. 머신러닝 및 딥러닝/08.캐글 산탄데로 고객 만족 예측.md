# Santander Customer Satisfaction

데이터 : [캐글 산탄데로 고객 만족 예측](https://www.kaggle.com/competitions/santander-customer-satisfaction/overview)

클래스 레이블 명은 TARGET이며 이 값이 1이면 불만을 가진 고객, 0이면 만족한 고객

---
## 데이터 전처리

```
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib
import warnings
warnings.filterwarnings('ignore')

cust_df = pd.read_csv(
    './santander-customer-satisfaction/train.csv'
    ,encoding='latin-1'
)

print(f'dataset shape : {cust_df.shape}')
cust_df.head()
```
![image](https://github.com/user-attachments/assets/2eb0b5c0-1549-4903-998f-d527ea13a187)

```
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib
import warnings
warnings.filterwarnings('ignore')

cust_df = pd.read_csv(
    './santander-customer-satisfaction/train.csv'
    ,encoding='latin-1'
)

print(cust_df['TARGET'].value_counts())

unsatisfied_cnt=cust_df[cust_df['TARGET']==1].TARGET.count()
total_cnt=cust_df.TARGET.count()
print(f'unsatisfied 비율은 : {unsatisfied_cnt/total_cnt:.2f}')
```
![image](https://github.com/user-attachments/assets/b755a97d-90a9-4284-8597-01eca6e296c5)

```
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib
import warnings
warnings.filterwarnings('ignore')

cust_df = pd.read_csv(
    './santander-customer-satisfaction/train.csv'
    ,encoding='latin-1'
)

unsatisfied_cnt=cust_df[cust_df['TARGET']==1].TARGET.count()
total_cnt=cust_df.TARGET.count()

cust_df.describe()
```
![image](https://github.com/user-attachments/assets/9571e95f-a091-4aa8-9dfe-82a2aa6f8a95)

```
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib
import warnings
warnings.filterwarnings('ignore')

cust_df = pd.read_csv(
    './santander-customer-satisfaction/train.csv'
    ,encoding='latin-1'
)

unsatisfied_cnt=cust_df[cust_df['TARGET']==1].TARGET.count()
total_cnt=cust_df.TARGET.count()

print(f"cust_df['var3']의 min값 : {cust_df['var3'].min()}")
print(f"cust_df['var3']의 max값 : {cust_df['var3'].max()}")
print(f"cust_df['var3']의 mean값 : {cust_df['var3'].mean()}")
print(f"cust_df['var3']의 std값 : {cust_df['var3'].std()}")
print(f"cust_df['var3']의 var(분산)값 : {cust_df['var3'].var()}")

invalid_values_count = (cust_df['var3'] == -999999).sum()
print(f"'var3'에서 -999999인 값의 개수: {invalid_values_count}")
```
![image](https://github.com/user-attachments/assets/f22a77f2-4da6-43a2-a3c9-8f9c6665cf67)

> var3 칼럼의 경우 min 값이 -999999입니다.
> var3은 숫자 형이고, 다른 값에 비해 -999999은 너무 편차가 심하므로 -999999를 다른 값으로 변환하여 처리하겠습니다.

```
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib
import warnings
warnings.filterwarnings('ignore')

cust_df = pd.read_csv(
    './santander-customer-satisfaction/train.csv'
    ,encoding='latin-1'
)

# 데이터 전처리 : -999999 값을 제일 많은 2로 변환
cust_df['var3'].replace(-999999,2,inplace=True)

# ID feature은 일련번호로 의미가 없으므로 삭제를 한다
cust_df.drop(
    'ID'
    ,axis=1
    ,inplace=True
)

cust_df.describe()

```
![image](https://github.com/user-attachments/assets/a3e4d140-b385-4ef9-a844-0726309093ac)

```
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib
import warnings
warnings.filterwarnings('ignore')

cust_df = pd.read_csv(
    './santander-customer-satisfaction/train.csv'
    ,encoding='latin-1'
)

# 데이터 전처리 : -999999 값을 제일 많은 2로 변환
cust_df['var3'].replace(-999999,2,inplace=True)

# ID feature은 일련번호로 의미가 없으므로 삭제를 한다
cust_df.drop(
    'ID'
    ,axis=1
    ,inplace=True
)

# 데이터 / 레이블 분리
X_features=cust_df.iloc[:,:-1]
y_labels=cust_df.loc[:,'TARGET']


print(f'전체 데이터 구조 : {cust_df.shape}')
print(f'데이터 구조 : {X_features.shape}')
print(f'타겟 데이터 구조 : {y_labels.shape}')
```
![image](https://github.com/user-attachments/assets/8533d19b-0165-4cc9-8cf4-583e77ea0ef5)

```
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib
import warnings
warnings.filterwarnings('ignore')

cust_df = pd.read_csv(
    './santander-customer-satisfaction/train.csv'
    ,encoding='latin-1'
)

# 데이터 전처리 : -999999 값을 제일 많은 2로 변환
cust_df['var3'].replace(-999999,2,inplace=True)

# ID feature은 일련번호로 의미가 없으므로 삭제를 한다
cust_df.drop(
    'ID'
    ,axis=1
    ,inplace=True
)

# 데이터 / 레이블 분리
X_features=cust_df.iloc[:,:-1]
y_labels=cust_df.loc[:,'TARGET']

# 학습/테스트 데이터 분리
from sklearn.model_selection import train_test_split

X_train,X_test,y_train,y_test=train_test_split(
    X_features
    ,y_labels
    ,test_size=0.2
    ,random_state=0
    ,stratify=y_labels 
)

# 학습/테스트 레이블의 균형성 확인
# 학습/테스트 레이블의 개수 저장
train_cnt=y_train.count() # 학습데이터 레이블의 개수
test_cnt=y_test.count() # 테스트 데이터 레이블의 개수

print(f'학습 세트 Shape : {X_train.shape}, 테스트 세트 Shape : {X_test.shape}')
print('='*50)
print(f'학습 세트 레이블 값 분포 비율\n{y_train.value_counts()/train_cnt}')
print('='*50)
print(f'테스트 세트 레이블 값 분포 비율\n{y_test.value_counts()/test_cnt}')
```
![image](https://github.com/user-attachments/assets/4b43fdda-2d5f-4193-a261-81e74a2b605c)

```
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib
import warnings
warnings.filterwarnings('ignore')

cust_df = pd.read_csv(
    './santander-customer-satisfaction/train.csv'
    ,encoding='latin-1'
)

# 데이터 전처리 : -999999 값을 제일 많은 2로 변환
cust_df['var3'].replace(-999999,2,inplace=True)

# ID feature은 일련번호로 의미가 없으므로 삭제를 한다
cust_df.drop(
    'ID'
    ,axis=1
    ,inplace=True
)

# 데이터 / 레이블 분리
X_features=cust_df.iloc[:,:-1]
y_labels=cust_df.loc[:,'TARGET']

# 학습/테스트 데이터 분리
from sklearn.model_selection import train_test_split

X_train,X_test,y_train,y_test=train_test_split(
    X_features
    ,y_labels
    ,test_size=0.2
    ,random_state=0
    ,stratify=y_labels 
)

# 학습/테스트 레이블의 균형성 확인
# 학습/테스트 레이블의 개수 저장
train_cnt=y_train.count() # 학습데이터 레이블의 개수
test_cnt=y_test.count() # 테스트 데이터 레이블의 개수

X_tr,X_val,y_tr,y_val=train_test_split(
    X_train
    ,y_train
    ,test_size=0.3
    ,random_state=0
)

from xgboost import XGBClassifier
from sklearn.metrics import roc_auc_score

xgb_clf=XGBClassifier(
    n_estimators=500
    ,learning_rate=0.05
    ,early_stopping=100
    ,eval_metric='auc'
    ,random_state=156
)

xgb_clf.fit(
    X_tr
    ,y_tr
    ,eval_set=[
        (
            X_val,y_val
        )
    ]
)
```
![image](https://github.com/user-attachments/assets/ce4d1c1a-cd4f-4c3e-9b78-d2e6601caf64)
