pytorch ì„¤ì • 
nvidia ë²„ì „ì´ 1660ì´ì–´ì„œ cuda 11.8ìœ¼ë¡œ ë‹¤ìš´ì„ í•˜ì—¬ ì„¤ì •ì„ ì™„ë£Œ í•´ì¤ë‹ˆë‹¤. ê·¸ í›„ ì•„ë˜ ëª…ë ¹ì–´ë¡œ ì„¤ì¹˜ë¥¼ í•©ë‹ˆë‹¤.

```
pip install --no-cache-dir torch==2.1.1+cu118 torchvision==0.16.1+cu118 -f https://download.pytorch.org/whl/torch_stable.html
```
```
pip install numpy==1.23.5
```
ì•„ë˜ ëª…ë ¹ì–´ë¡œ í™•ì¸ì„ í•©ë‹ˆë‹¤.
```
import torch


# CUDA(GPU) ì‚¬ìš© ê°€ëŠ¥í•œì§€ í™•ì¸ (True: GPU ì‚¬ìš© ê°€ëŠ¥, False: ì‚¬ìš© ë¶ˆê°€)
gpu_available = torch.cuda.is_available()
print(f'GPU ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€: {gpu_available}')


if gpu_available:
    # ì‚¬ìš© ê°€ëŠ¥í•œ GPU ê°œìˆ˜ í™•ì¸
    gpu_count = torch.cuda.device_count()
    print(f'ì‚¬ìš© ê°€ëŠ¥í•œ GPU ê°œìˆ˜: {gpu_count}')


    # GPU ì´ë¦„ê³¼ ì‚¬ì–‘ í™•ì¸
    for gpu_idx in range(gpu_count):
        gpu_name = torch.cuda.get_device_name(gpu_idx)
        print(f'GPU {gpu_idx}: {gpu_name}')


    # í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ GPU ë²ˆí˜¸ í™•ì¸
    current_gpu = torch.cuda.current_device()
    print(f'í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ GPU ë²ˆí˜¸: {current_gpu}')


else:
    print("GPUê°€ ê°ì§€ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. CPUë¥¼ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤.")
```
![image](https://github.com/user-attachments/assets/0b3f9352-b37d-4156-a1f7-ca100c93b7e7)

---
## íŒŒì´í† ì¹˜ íƒ ì„œ ìƒì„±
```
import torch
import numpy as np

# ë„˜íŒŒì´ í™˜ê²½ ì„¤ì • : ì†Œìˆ˜ì  3ìë¦¬ê¹Œì§€ í‘œì‹œ
np.set_printoptions(precision=3)

# ë¦¬ìŠ¤íŠ¸ ìƒì„±
a=[1,2,3]

# array ìƒì„±
b=np.array(
    [4,5,6]
    ,dtype=np.int32
)

# ë¦¬ìŠ¤íŠ¸ë¡œ íƒ ì„œ ìƒì„±
t_a=torch.tensor(a)
print(t_a)

# array -> tensor
t_b=torch.from_numpy(b)
print(t_b)
```
![image](https://github.com/user-attachments/assets/0f2a378d-78a4-4d57-a771-b4f915760828)

```
# tensor create : one

import torch

t_ones=torch.ones(2,3) # 2,3ì€ 2 rox x 3 col ë¡œ í•˜ê² ë‹¤ëŠ” ì˜ë¯¸

t_ones
```
![image](https://github.com/user-attachments/assets/6cee664a-285c-4c6a-9252-fea53041a70e)

```
t_ones=torch.zeros(2,3) # 2,3ì€ 2 rox x 3 col ë¡œ í•˜ê² ë‹¤ëŠ” ì˜ë¯¸

t_ones
```
![image](https://github.com/user-attachments/assets/1e4c7a8a-5ecc-4e85-8254-f10f5204e7f6)

---
## íƒ ì„œ ë°ì´í„° íƒ€ì…ê³¼ í¬ê¸° ì¡°ì‘

```
import torch

# í…ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë‹¤ì°¨ì› ë°°ì—´ì„ ì˜ë¯¸í•˜ëŠ”ë°, ë²¡í„°ë‚˜ í–‰ë ¬ì„ í¬í•¨í•˜ëŠ” ë” ì¼ë°˜ì ì¸ ê°œë…ì´ë¼ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
# torch.to() : íƒ ì„œë¥¼ ë‹¤ë¥¸ ì¥ì¹˜ë‚˜ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ì´ë™í• ë•Œ ì‚¬ìš©
tensor_ = torch.tensor([1, 2, 3])

print(f'tensor_ : {tensor_}')  # ì €ì¥ë˜ ìˆëŠ” ìœ„ì¹˜ê°€ dram

# tensor ê°ì²´ì—ì„œ 'to' ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ GPUë¡œ ì´ë™
tensor_gpu = tensor_.to('cuda')

print(f'tensor_gpu : {tensor_gpu}')
```
![image](https://github.com/user-attachments/assets/97e4dad2-1ac0-4d9e-bf43-7eea4388c13a)

```
import torch


# í…ì„œ ì „ì¹˜í•˜ê¸°
t=torch.rand(3,5)
t_tr=torch.transpose(t,0,1)
print(f't shape : {t.shape}, t_tr shape : {t_tr.shape}')
print(f't : {t}')
print(f't_tr : {t_tr}')
```
![image](https://github.com/user-attachments/assets/d732f154-53a0-4aac-898b-a7ec8a9a46e0)

```
# í…ì„œ í¬ê¸° ë³€ê²½ : reshape
t=torch.zeros(30)
print(t)
t_reshape=t.reshape(5,6)
print(t_reshape)
```
![image](https://github.com/user-attachments/assets/4ead4551-81f4-4950-b92e-a3a6a8ba73fe)

```
# ë¶ˆí•„ìš”í•œ ì°¨ì› ì‚­ì œ : squeeze
t=torch.zeros(1,2,1,4,1) # 5ì°¨ì›ì´ë‹¤
print(t)

print(f't shape : {t.shape}')
t_squeeze=t.squeeze(
    2
)
print(t_squeeze)
print(f't_squeeze shape : {t_squeeze.shape}')
```
![image](https://github.com/user-attachments/assets/97ff492d-edd1-4a45-9d2a-6fa23a12f571)

```
import numpy as np
import torch
# ì°¨ì› ì¶”ê°€ : unsqueeze
t=torch.tensor(
    [1,2,3]
)
print(f't shape : {t.shape}')
print(t)

t_n=np.array(
    [1,2,3]
)
print(f't_n shape : {t_n.shape}')

# í…ì„œ ì°¨ì› ì¶”ê°€
u_t=t.unsqueeze(0) # 0 ë²ˆì§¸ ì°¨ì› ì¶”ê°€

print(f'u_t shape : {u_t.shape}')
print(u_t)
```
![image](https://github.com/user-attachments/assets/fdb43aa6-e925-4f73-aa8a-cd1e2c5dacd4)

```
# element-wise : ì›ì†Œë³„ ì—°ì‚°
# ì›ì†Œë³„ ê³±ì…ˆ
torch.manual_seed(1)
t1=2*torch.rand(5,2)-1
print(t1)
```
![image](https://github.com/user-attachments/assets/8142a826-0183-4378-8081-0133a4486200)

```
# element-wise : ì›ì†Œë³„ ì—°ì‚°
# ì›ì†Œë³„ ê³±ì…ˆ
torch.manual_seed(1)
t1=2*torch.rand(5,2)-1
print(t1)
t2=torch.normal(mean=0,std=1,size=(5,2))
print(t2)
t3=torch.multiply(t1,t2)
print(t3)
```
![image](https://github.com/user-attachments/assets/84d2c77b-ef38-46a7-895c-fc12a42f76c8)

```
# í–‰ë ¬ ê³± : dot product (ë‚´ì )
t1=2*torch.rand(5,2)-1
print(t1.shape)
t2=torch.normal(mean=0,std=1,size=(5,2))
print(t2.shape)
print(torch.transpose(t2,0,1))
t5= torch.matmul(t1,torch.transpose(t2,0,1))
print(t5)
print(t5.shape)
```
![image](https://github.com/user-attachments/assets/85629cf0-f892-4e75-8093-7e93b68d26e8)

---
## íŒŒì´í† ì¹˜ ì…ë ¥ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

```
import torch
from torch.utils.data import DataLoader
t=torch.arange(6,dtype=torch.float32)
data_loader=DataLoader(t)

for item in data_loader:
    print(item)     
print('='*100)
data_loader=DataLoader(t,batch_size=3,drop_last=False)
for batch in data_loader:
    print(f'batch : {batch}')  
print('='*100)
data_loader=DataLoader(t,batch_size=3,drop_last=True)
for batch in data_loader:
    print(f'batch : {batch}')
```
![image](https://github.com/user-attachments/assets/6b443984-40d4-426f-aa8d-b48c7ae63f22)

```
import torch
from torch.utils.data import DataLoader
t=torch.arange(7,dtype=torch.float32)
data_loader=DataLoader(t)

for item in data_loader:
    print(item)     
print('='*100)
data_loader=DataLoader(t,batch_size=3,drop_last=False)
for batch in data_loader:
    print(f'batch : {batch}')  
print('='*100)
data_loader=DataLoader(t,batch_size=3,drop_last=True)
for batch in data_loader:
    print(f'batch : {batch}')
```
![image](https://github.com/user-attachments/assets/42300249-a7f5-4170-8865-f6770f4b0489)

```
from torch.utils.data import DataLoader,TensorDataset

# í…ì„œ ë°ì´í„° ì¤€ë¹„
f=torch.randn(100,3)
print(f'í…ì„œ êµ¬ì¡° : {f.shape}')
for idx in range(len(f)):
    print(f[idx])
print('='*100)
labels=torch.randint(0,2,(100,))
print(f'labels shape: {labels.shape}')
print(f'lables :\n{labels}')
print('='*100)
# í…ì„œë¥¼ ì´ìš©í•œ ë°ì´í„°ì…‹ì„ ìƒì„±
dataset=TensorDataset(f,labels)
print(dataset[0])
for idx in range(len(dataset)):
    print(f'{idx}ë²ˆì§¸ datset : {dataset[idx]}')
```
```
í…ì„œ êµ¬ì¡° : torch.Size([100, 3])
tensor([ 0.5965, -0.2248, -1.3013])
tensor([-0.1356,  1.3967, -0.2600])
tensor([-0.7876, -0.4009, -0.0892])
tensor([-0.1714,  1.3057,  0.0668])
tensor([ 0.6350, -2.1654,  1.3780])
tensor([-1.5427,  0.8177,  0.7472])
tensor([ 0.3395, -1.5277, -0.9528])
tensor([-0.1002, -0.6491,  0.0774])
tensor([ 0.9316,  1.1905, -0.0228])
tensor([ 0.9538, -1.4761, -1.5200])
tensor([-1.3992,  0.2526, -1.0721])
tensor([ 0.5617, -0.1813,  0.6479])
tensor([-1.3754, -1.0257, -1.9801])
tensor([ 0.2045, -0.7652,  2.1713])
tensor([-0.0788, -0.1179, -0.7340])
tensor([-0.3688, -0.2374, -2.5091])
tensor([1.2371, 0.2285, 0.0802])
tensor([-1.4025, -0.3743,  1.2562])
tensor([-0.4114, -1.1657, -0.3619])
tensor([ 0.0813, -0.2030,  1.7867])
tensor([-1.8098, -0.4974, -0.3413])
tensor([ 0.0882, -1.4530,  1.7697])
tensor([ 0.8969,  0.0173, -1.7575])
tensor([ 0.4261, -0.5796,  0.0505])
tensor([-0.1233, -0.4801, -0.1846])
tensor([-0.7148, -0.5029,  0.1585])
tensor([ 0.0535, -0.1655,  0.1797])
tensor([ 0.0186, -0.7067, -0.0158])
tensor([ 1.4318,  2.8418, -0.9929])
tensor([ 1.4532, -0.7069, -0.5511])
tensor([-0.3846,  2.2370,  1.1127])
tensor([-0.1012, -0.1209,  1.4870])
tensor([ 1.5411, -1.8538,  0.3008])
tensor([ 1.6506,  0.0892, -1.1751])
tensor([-1.2228, -0.7439,  1.8599])
tensor([1.1933, 1.0049, 2.3180])
tensor([-0.3098, -0.4866, -1.2543])
tensor([0.0805, 0.2112, 1.6861])
tensor([-0.9734,  0.7408, -0.7772])
tensor([-1.6399, -1.0774, -0.6151])
tensor([-0.3536,  1.4637, -1.0469])
tensor([-1.4068,  0.5273,  1.1568])
tensor([-0.8616,  0.5580,  0.6418])
tensor([-0.9873, -1.2825, -0.7874])
tensor([ 2.5974,  1.0973, -0.1721])
tensor([-0.7066, -0.5636,  0.7665])
tensor([ 2.6821,  0.1160, -0.8742])
tensor([ 0.2659, -1.9265, -0.3953])
tensor([-0.6433, -1.0689,  0.1209])
tensor([1.2312, 0.5676, 0.4610])
tensor([-1.1579, -1.8862, -0.2570])
tensor([0.7474, 1.0907, 0.0654])
tensor([-3.0565e-01,  1.0469e-03,  1.4465e+00])
tensor([0.0050, 1.6177, 0.4709])
tensor([ 1.2555, -0.3513,  0.0651])
tensor([1.2227, 0.5333, 0.5360])
tensor([ 0.8766,  0.6157, -1.9573])
tensor([-0.1894, -0.1300,  1.2484])
tensor([ 1.0727, -0.6915,  0.2683])
tensor([ 0.0778,  0.1452, -0.7557])
tensor([-2.1238,  0.4668,  0.0973])
tensor([0.9798, 0.3907, 0.4044])
tensor([-0.3112,  0.0349, -0.4879])
tensor([-0.3432,  0.0858, -0.2718])
tensor([ 1.5555, -1.0168,  1.3520])
tensor([1.2340, 1.2053, 1.0867])
tensor([ 1.2288, -0.3632, -2.0115])
tensor([ 0.5870,  1.5174, -1.0761])
tensor([-0.1530,  0.4114, -0.1329])
tensor([-1.3254,  0.7425,  1.6147])
tensor([0.6477, 0.5770, 0.6615])
tensor([-0.0672,  0.0892,  0.6578])
tensor([1.8993, 1.1570, 1.8926])
tensor([-0.6104, -0.9517,  0.4295])
tensor([ 0.3012, -0.6417,  0.4153])
tensor([ 1.0272, -0.0930,  0.7601])
tensor([ 0.7303,  0.3738, -1.0710])
tensor([-0.4233, -0.3168, -0.7196])
tensor([1.4817, 0.7792, 0.8348])
tensor([ 0.3894, -2.4872, -1.3875])
tensor([-0.1046, -0.3272, -0.3847])
tensor([-0.1513, -0.7124, -0.2907])
tensor([ 1.2453, -0.4189, -0.4971])
tensor([1.6850, 1.0114, 1.5273])
tensor([-0.7367,  0.2655, -0.0789])
tensor([-0.2676,  0.6184, -0.9178])
tensor([ 0.6649, -1.1846,  0.4253])
tensor([ 0.2321, -0.6932,  1.5286])
tensor([-1.1558,  1.0350,  0.6300])
tensor([-1.1531, -0.4977, -0.1588])
tensor([ 1.1468, -0.1172, -1.4771])
tensor([0.1248, 1.0104, 0.8202])
tensor([ 1.8008, -0.0524,  0.1364])
tensor([-1.2214, -0.5140, -0.4434])
tensor([-1.5338,  0.5087,  0.4622])
tensor([-1.2767, -2.5545, -0.3935])
tensor([0.2856, 1.1013, 0.0768])
tensor([-1.6010, -0.5405, -0.4149])
tensor([-0.3963, -0.4048,  0.5114])
tensor([-0.1092,  1.1605,  0.6342])
====================================================================================================
labels shape: torch.Size([100])
lables :
tensor([0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
        1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1,
        1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1,
        1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1,
        0, 1, 1, 0])
====================================================================================================
(tensor([ 0.5965, -0.2248, -1.3013]), tensor(0))
0ë²ˆì§¸ datset : (tensor([ 0.5965, -0.2248, -1.3013]), tensor(0))
1ë²ˆì§¸ datset : (tensor([-0.1356,  1.3967, -0.2600]), tensor(0))
2ë²ˆì§¸ datset : (tensor([-0.7876, -0.4009, -0.0892]), tensor(0))
3ë²ˆì§¸ datset : (tensor([-0.1714,  1.3057,  0.0668]), tensor(0))
4ë²ˆì§¸ datset : (tensor([ 0.6350, -2.1654,  1.3780]), tensor(1))
5ë²ˆì§¸ datset : (tensor([-1.5427,  0.8177,  0.7472]), tensor(1))
6ë²ˆì§¸ datset : (tensor([ 0.3395, -1.5277, -0.9528]), tensor(1))
7ë²ˆì§¸ datset : (tensor([-0.1002, -0.6491,  0.0774]), tensor(1))
8ë²ˆì§¸ datset : (tensor([ 0.9316,  1.1905, -0.0228]), tensor(0))
9ë²ˆì§¸ datset : (tensor([ 0.9538, -1.4761, -1.5200]), tensor(0))
10ë²ˆì§¸ datset : (tensor([-1.3992,  0.2526, -1.0721]), tensor(0))
11ë²ˆì§¸ datset : (tensor([ 0.5617, -0.1813,  0.6479]), tensor(1))
12ë²ˆì§¸ datset : (tensor([-1.3754, -1.0257, -1.9801]), tensor(1))
13ë²ˆì§¸ datset : (tensor([ 0.2045, -0.7652,  2.1713]), tensor(0))
14ë²ˆì§¸ datset : (tensor([-0.0788, -0.1179, -0.7340]), tensor(0))
15ë²ˆì§¸ datset : (tensor([-0.3688, -0.2374, -2.5091]), tensor(0))
16ë²ˆì§¸ datset : (tensor([1.2371, 0.2285, 0.0802]), tensor(1))
17ë²ˆì§¸ datset : (tensor([-1.4025, -0.3743,  1.2562]), tensor(1))
18ë²ˆì§¸ datset : (tensor([-0.4114, -1.1657, -0.3619]), tensor(1))
19ë²ˆì§¸ datset : (tensor([ 0.0813, -0.2030,  1.7867]), tensor(1))
20ë²ˆì§¸ datset : (tensor([-1.8098, -0.4974, -0.3413]), tensor(0))
21ë²ˆì§¸ datset : (tensor([ 0.0882, -1.4530,  1.7697]), tensor(0))
22ë²ˆì§¸ datset : (tensor([ 0.8969,  0.0173, -1.7575]), tensor(1))
23ë²ˆì§¸ datset : (tensor([ 0.4261, -0.5796,  0.0505]), tensor(1))
24ë²ˆì§¸ datset : (tensor([-0.1233, -0.4801, -0.1846]), tensor(1))
25ë²ˆì§¸ datset : (tensor([-0.7148, -0.5029,  0.1585]), tensor(0))
26ë²ˆì§¸ datset : (tensor([ 0.0535, -0.1655,  0.1797]), tensor(1))
27ë²ˆì§¸ datset : (tensor([ 0.0186, -0.7067, -0.0158]), tensor(0))
28ë²ˆì§¸ datset : (tensor([ 1.4318,  2.8418, -0.9929]), tensor(1))
29ë²ˆì§¸ datset : (tensor([ 1.4532, -0.7069, -0.5511]), tensor(0))
30ë²ˆì§¸ datset : (tensor([-0.3846,  2.2370,  1.1127]), tensor(0))
31ë²ˆì§¸ datset : (tensor([-0.1012, -0.1209,  1.4870]), tensor(1))
32ë²ˆì§¸ datset : (tensor([ 1.5411, -1.8538,  0.3008]), tensor(1))
33ë²ˆì§¸ datset : (tensor([ 1.6506,  0.0892, -1.1751]), tensor(1))
34ë²ˆì§¸ datset : (tensor([-1.2228, -0.7439,  1.8599]), tensor(1))
35ë²ˆì§¸ datset : (tensor([1.1933, 1.0049, 2.3180]), tensor(1))
36ë²ˆì§¸ datset : (tensor([-0.3098, -0.4866, -1.2543]), tensor(1))
37ë²ˆì§¸ datset : (tensor([0.0805, 0.2112, 1.6861]), tensor(0))
38ë²ˆì§¸ datset : (tensor([-0.9734,  0.7408, -0.7772]), tensor(1))
39ë²ˆì§¸ datset : (tensor([-1.6399, -1.0774, -0.6151]), tensor(0))
40ë²ˆì§¸ datset : (tensor([-0.3536,  1.4637, -1.0469]), tensor(1))
41ë²ˆì§¸ datset : (tensor([-1.4068,  0.5273,  1.1568]), tensor(1))
42ë²ˆì§¸ datset : (tensor([-0.8616,  0.5580,  0.6418]), tensor(0))
43ë²ˆì§¸ datset : (tensor([-0.9873, -1.2825, -0.7874]), tensor(0))
44ë²ˆì§¸ datset : (tensor([ 2.5974,  1.0973, -0.1721]), tensor(1))
45ë²ˆì§¸ datset : (tensor([-0.7066, -0.5636,  0.7665]), tensor(0))
46ë²ˆì§¸ datset : (tensor([ 2.6821,  0.1160, -0.8742]), tensor(0))
47ë²ˆì§¸ datset : (tensor([ 0.2659, -1.9265, -0.3953]), tensor(1))
48ë²ˆì§¸ datset : (tensor([-0.6433, -1.0689,  0.1209]), tensor(1))
49ë²ˆì§¸ datset : (tensor([1.2312, 0.5676, 0.4610]), tensor(1))
50ë²ˆì§¸ datset : (tensor([-1.1579, -1.8862, -0.2570]), tensor(1))
51ë²ˆì§¸ datset : (tensor([0.7474, 1.0907, 0.0654]), tensor(1))
52ë²ˆì§¸ datset : (tensor([-3.0565e-01,  1.0469e-03,  1.4465e+00]), tensor(0))
53ë²ˆì§¸ datset : (tensor([0.0050, 1.6177, 0.4709]), tensor(1))
54ë²ˆì§¸ datset : (tensor([ 1.2555, -0.3513,  0.0651]), tensor(1))
55ë²ˆì§¸ datset : (tensor([1.2227, 0.5333, 0.5360]), tensor(0))
56ë²ˆì§¸ datset : (tensor([ 0.8766,  0.6157, -1.9573]), tensor(1))
57ë²ˆì§¸ datset : (tensor([-0.1894, -0.1300,  1.2484]), tensor(1))
58ë²ˆì§¸ datset : (tensor([ 1.0727, -0.6915,  0.2683]), tensor(0))
59ë²ˆì§¸ datset : (tensor([ 0.0778,  0.1452, -0.7557]), tensor(1))
60ë²ˆì§¸ datset : (tensor([-2.1238,  0.4668,  0.0973]), tensor(0))
61ë²ˆì§¸ datset : (tensor([0.9798, 0.3907, 0.4044]), tensor(0))
62ë²ˆì§¸ datset : (tensor([-0.3112,  0.0349, -0.4879]), tensor(0))
63ë²ˆì§¸ datset : (tensor([-0.3432,  0.0858, -0.2718]), tensor(0))
64ë²ˆì§¸ datset : (tensor([ 1.5555, -1.0168,  1.3520]), tensor(1))
65ë²ˆì§¸ datset : (tensor([1.2340, 1.2053, 1.0867]), tensor(0))
66ë²ˆì§¸ datset : (tensor([ 1.2288, -0.3632, -2.0115]), tensor(1))
67ë²ˆì§¸ datset : (tensor([ 0.5870,  1.5174, -1.0761]), tensor(1))
68ë²ˆì§¸ datset : (tensor([-0.1530,  0.4114, -0.1329]), tensor(0))
69ë²ˆì§¸ datset : (tensor([-1.3254,  0.7425,  1.6147]), tensor(0))
70ë²ˆì§¸ datset : (tensor([0.6477, 0.5770, 0.6615]), tensor(1))
71ë²ˆì§¸ datset : (tensor([-0.0672,  0.0892,  0.6578]), tensor(1))
72ë²ˆì§¸ datset : (tensor([1.8993, 1.1570, 1.8926]), tensor(1))
73ë²ˆì§¸ datset : (tensor([-0.6104, -0.9517,  0.4295]), tensor(0))
74ë²ˆì§¸ datset : (tensor([ 0.3012, -0.6417,  0.4153]), tensor(0))
75ë²ˆì§¸ datset : (tensor([ 1.0272, -0.0930,  0.7601]), tensor(0))
76ë²ˆì§¸ datset : (tensor([ 0.7303,  0.3738, -1.0710]), tensor(1))
77ë²ˆì§¸ datset : (tensor([-0.4233, -0.3168, -0.7196]), tensor(1))
78ë²ˆì§¸ datset : (tensor([1.4817, 0.7792, 0.8348]), tensor(1))
79ë²ˆì§¸ datset : (tensor([ 0.3894, -2.4872, -1.3875]), tensor(0))
80ë²ˆì§¸ datset : (tensor([-0.1046, -0.3272, -0.3847]), tensor(1))
81ë²ˆì§¸ datset : (tensor([-0.1513, -0.7124, -0.2907]), tensor(1))
82ë²ˆì§¸ datset : (tensor([ 1.2453, -0.4189, -0.4971]), tensor(0))
83ë²ˆì§¸ datset : (tensor([1.6850, 1.0114, 1.5273]), tensor(0))
84ë²ˆì§¸ datset : (tensor([-0.7367,  0.2655, -0.0789]), tensor(0))
85ë²ˆì§¸ datset : (tensor([-0.2676,  0.6184, -0.9178]), tensor(0))
86ë²ˆì§¸ datset : (tensor([ 0.6649, -1.1846,  0.4253]), tensor(1))
87ë²ˆì§¸ datset : (tensor([ 0.2321, -0.6932,  1.5286]), tensor(1))
88ë²ˆì§¸ datset : (tensor([-1.1558,  1.0350,  0.6300]), tensor(0))
89ë²ˆì§¸ datset : (tensor([-1.1531, -0.4977, -0.1588]), tensor(0))
90ë²ˆì§¸ datset : (tensor([ 1.1468, -0.1172, -1.4771]), tensor(0))
91ë²ˆì§¸ datset : (tensor([0.1248, 1.0104, 0.8202]), tensor(1))
92ë²ˆì§¸ datset : (tensor([ 1.8008, -0.0524,  0.1364]), tensor(1))
93ë²ˆì§¸ datset : (tensor([-1.2214, -0.5140, -0.4434]), tensor(0))
94ë²ˆì§¸ datset : (tensor([-1.5338,  0.5087,  0.4622]), tensor(1))
95ë²ˆì§¸ datset : (tensor([-1.2767, -2.5545, -0.3935]), tensor(1))
96ë²ˆì§¸ datset : (tensor([0.2856, 1.1013, 0.0768]), tensor(0))
97ë²ˆì§¸ datset : (tensor([-1.6010, -0.5405, -0.4149]), tensor(1))
98ë²ˆì§¸ datset : (tensor([-0.3963, -0.4048,  0.5114]), tensor(1))
99ë²ˆì§¸ datset : (tensor([-0.1092,  1.1605,  0.6342]), tensor(0))
```
```
from torch.utils.data import DataLoader,TensorDataset

# í…ì„œ ë°ì´í„° ì¤€ë¹„
f=torch.randn(100,3)
# print(f'í…ì„œ êµ¬ì¡° : {f.shape}')
# for idx in range(len(f)):
    # print(f[idx])
# print('='*100)
labels=torch.randint(0,2,(100,))
# print(f'labels shape: {labels.shape}')
# print(f'lables :\n{labels}')
# print('='*100)
# í…ì„œë¥¼ ì´ìš©í•œ ë°ì´í„°ì…‹ì„ ìƒì„±
dataset=TensorDataset(f,labels)
# print(dataset[0])
# for idx in range(len(dataset)):
    # print(f'{idx}ë²ˆì§¸ datset : {dataset[idx]}')
# ë°ì´í„°ë¡œë” ìƒì„±
data_loader=DataLoader(dataset=dataset,batch_size=16,shuffle=True)
for batch_features, batch_labels in data_loader:
    print(f'ë°°ì¹˜ ì‚¬ì´ì¦ˆ : {batch_features.size()}, ë°°ì¹˜ ë¼ë²¨ ì‚¬ì´ì¦ˆ : {batch_labels.size()}')
```
![image](https://github.com/user-attachments/assets/95ce3db0-2cec-4a4d-9b9f-4e740cf3a361)

---

---

## ğŸ§  ì„ë² ë”©(Embedding)ì´ë€?

### ğŸ“Œ ê°œìš”

**ì„ë² ë”©(Embedding)** ì€ ì¸ê°„ì˜ ì–¸ì–´ë¥¼ ê¸°ê³„ê°€ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ìˆ˜ì¹˜í™”í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. êµ¬ì²´ì ìœ¼ë¡œëŠ” ë‹¨ì–´ë‚˜ ë¬¸ì¥, ë¬¸ì„œë¥¼ ê³ ì°¨ì› ë²¡í„° ê³µê°„ì˜ ì (ìˆ«ì ë°°ì—´)ìœ¼ë¡œ ë³€í™˜í•˜ì—¬, ê·¸ ì˜ë¯¸ë‚˜ ê´€ê³„ì„±ì„ ìˆ˜í•™ì ìœ¼ë¡œ ë¶„ì„í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.


### ğŸ” ì„ë² ë”©ì˜ ëª©ì 

ì„ë² ë”©ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

- âœ… í…ìŠ¤íŠ¸ ê°„ **ì˜ë¯¸ ìœ ì‚¬ë„** ë¹„êµ ê°€ëŠ¥  
- ğŸ” ì˜ë¯¸ ê¸°ë°˜ì˜ **ê²€ìƒ‰ ë° ì¶”ì²œ** ì‹œìŠ¤í…œ êµ¬í˜„  
- ğŸ§© í…ìŠ¤íŠ¸ë¥¼ ìˆ˜ì¹˜ë¡œ ë³€í™˜í•˜ì—¬ **ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì— ì…ë ¥** ê°€ëŠ¥  
- ğŸ“Š ì°¨ì› ì¶•ì†Œë‚˜ êµ°ì§‘í™” ë“± **ë°ì´í„° ë¶„ì„**ì— í™œìš© ê°€ëŠ¥


### ğŸ§­ ì˜ˆ: ë‹¨ì–´ë¥¼ ë²¡í„°ë¡œ

ì˜ˆë¥¼ ë“¤ì–´ `"openai"`ì™€ `"upstate"`ë¼ëŠ” ë‘ ë‹¨ì–´ê°€ ìˆì„ ë•Œ, ê°ê°ì„ ì„ë² ë”©í•˜ë©´ ì•„ë˜ì²˜ëŸ¼ ê³ ì°¨ì› ë²¡í„°ë¡œ í‘œí˜„ë©ë‹ˆë‹¤:

- `"openai"` â†’ `[0.123, -0.045, ..., 0.889]`
- `"upstate"` â†’ `[0.321, 0.776, ..., -0.214]`

ì´ ë‘ ë²¡í„°ì˜ ë°©í–¥ì´ë‚˜ ê±°ë¦¬ë¥¼ í†µí•´ ë‘ ë‹¨ì–´ê°€ ì–¼ë§ˆë‚˜ **ì˜ë¯¸ì ìœ¼ë¡œ ê°€ê¹Œìš´ì§€** ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


### ğŸ“ ë²¡í„° ê³µê°„ì˜ íŠ¹ì§•

- ë‹¨ì–´ ê°„ì˜ **ì˜ë¯¸ì  ìœ ì‚¬ì„±**ì€ ë²¡í„° ê°„ì˜ **ê±°ë¦¬** ë˜ëŠ” **ê°ë„**ë¡œ ì¸¡ì •í•©ë‹ˆë‹¤.  
- ìì£¼ ê°™ì´ ì“°ì´ê±°ë‚˜ ë¹„ìŠ·í•œ ë§¥ë½ì—ì„œ ë“±ì¥í•˜ëŠ” ë‹¨ì–´ë“¤ì€ **ë¹„ìŠ·í•œ ë²¡í„°**ë¥¼ ê°€ì§‘ë‹ˆë‹¤.  
- ë°˜ëŒ€ë¡œ ì˜ë¯¸ê°€ ì „í˜€ ë‹¤ë¥¸ ë‹¨ì–´ëŠ” **ë©€ë¦¬ ë–¨ì–´ì§„ ìœ„ì¹˜**ì— ì¡´ì¬í•©ë‹ˆë‹¤.


### ğŸ§  ì„ë² ë”©ì˜ í™œìš© ë¶„ì•¼

| ë¶„ì•¼ | ì„¤ëª… |
|------|------|
| ì˜ë¯¸ ê¸°ë°˜ ê²€ìƒ‰ | í‚¤ì›Œë“œê°€ ì•„ë‹Œ ì˜ë¯¸ë¡œ ìœ ì‚¬ ë¬¸ì„œë¥¼ ì°¾ìŒ |
| ì±—ë´‡ ë° ì§ˆë¬¸ ì‘ë‹µ | ì§ˆë¬¸ê³¼ ê´€ë ¨ëœ ë‹µë³€ì„ ì˜ë¯¸ ë²¡í„°ë¡œ ì°¾ì•„ëƒ„ |
| ì¶”ì²œ ì‹œìŠ¤í…œ | ì‚¬ìš©ìì˜ í–‰ë™ ë˜ëŠ” ê´€ì‹¬ì‚¬ì™€ ìœ ì‚¬í•œ í•­ëª© ì¶”ì²œ |
| ê°ì • ë¶„ì„ | ë¬¸ì¥ì˜ ë²¡í„°ë¥¼ ë¶„ì„í•˜ì—¬ ê¸ì •/ë¶€ì • ê°ì • ë¶„ë¥˜ |


### ğŸ›  ì„ë² ë”© ëª¨ë¸ ì˜ˆì‹œ

- **OpenAI**: `text-embedding-ada-002` ëª¨ë¸ì€ ëŒ€í‘œì ì¸ ê³ ì„±ëŠ¥ í…ìŠ¤íŠ¸ ì„ë² ë”© ëª¨ë¸ì…ë‹ˆë‹¤.
- **ì¶œë ¥ ë²¡í„° í¬ê¸°**: 1536ì°¨ì›
- **ì…ë ¥**: ë‹¨ì–´, ë¬¸ì¥, ë¬¸ë‹¨ ëª¨ë‘ ê°€ëŠ¥
- **ì ìš© ì‚¬ë¡€**: ë²¡í„° ê²€ìƒ‰, ìœ ì‚¬ë„ ì¸¡ì •, ë¶„ë¥˜, í´ëŸ¬ìŠ¤í„°ë§ ë“±


### âœ… ìš”ì•½

- ì„ë² ë”©ì€ í…ìŠ¤íŠ¸ë¥¼ **ìˆ˜ì¹˜ ë²¡í„°ë¡œ ë³€í™˜**í•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤.
- ë²¡í„°ë¥¼ í†µí•´ ê¸°ê³„ëŠ” **ì˜ë¯¸ì  ìœ ì‚¬ì„±**ì„ ì´í•´í•˜ê³  í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ìì—°ì–´ì²˜ë¦¬(NLP)ì—ì„œ ê°€ì¥ í•µì‹¬ì ì¸ ê¸°ìˆ  ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.


### ğŸ”— ì°¸ê³  ë§í¬

- [OpenAI Embedding ë¬¸ì„œ](https://platform.openai.com/docs/guides/embeddings)
- [Word Embedding ê°œë… ì„¤ëª… (Wikipedia)](https://en.wikipedia.org/wiki/Word_embedding)

---
## ë¡œì»¬ ë””ìŠ¤í¬ì— ìˆëŠ” íŒŒì¼ì—ì„œ ë°ì´í„°ì…‹ ë§Œë“¤ê¸° 

```
import pathlib
imgdir_path=pathlib.Path('cat_dog_images')
file_list=sorted(
    [str(path) for path in imgdir_path.glob('*.jpg')]
)
print(file_list)
```
![image](https://github.com/user-attachments/assets/2043b840-712e-4376-bba0-88ea42887b9c)

```
import numpy as np
import matplotlib.pyplot as plt
import os
from PIL import Image
import pathlib
imgdir_path=pathlib.Path('cat_dog_images')
file_list=sorted(
    [str(path) for path in imgdir_path.glob('*.jpg')]
)
fig=plt.figure(figsize=(10,5))
for i, file in enumerate(file_list):
    img=Image.open(file)
    print(f'Image shape : {np.array(img).shape}')
    ax = fig.add_subplot(2,3,i+1)
    ax.set_xticks([])
    ax.set_yticks([])
    ax.imshow(img)
    ax.set_title(os.path.basename(file),size=15)
plt.tight_layout()
plt.show()
```
![image](https://github.com/user-attachments/assets/d5aae431-07d2-4af2-b030-8142fb93bd7d)

```
# íŒŒì¼ëª…ì—ì„œ ë ˆì´ë¸” ì¶”ì¶œ : ê°•ì•„ì§€(dog)=>1, ê³ ì–‘ì´(cat)=>0
labels=[1 if 'dog' in os.path.basename(files) else 0 for files in file_list]
print(labels)
```
![image](https://github.com/user-attachments/assets/5b598618-9204-473d-97a4-488196ec858c)

```
# Dataset ìƒì„±: ë°ì´í„°(file_list), ë ˆì´ë¸”(labels) ë¬¶ëŠ”ë‹¤
from torch.utils.data import Dataset
class ImageDataset(Dataset):
    def __init__(self,file_list,labels):
        self.file_list=file_list
        self.labels=labels
    
    def __getitem__(self, index):
        file=self.file_list[index]
        label=self.labels[index]
        return file, label
    
    def __len__(self):
        return len(self.labels)
    
image_dataset=ImageDataset(file_list,labels)

for file, label in image_dataset:
    print(f'{file} : {label}')
```
![image](https://github.com/user-attachments/assets/f0cd0241-86b0-4a97-8d4f-3c56319fcdca)

```
import torchvision.transforms as transforms
from torch.utils.data import Dataset
import numpy as np
from PIL import Image  # ì´ë¯¸ì§€ ì—´ê¸° ìœ„í•´ í•„ìš”
import matplotlib.pyplot as plt  # ì‹œê°í™”ë¥¼ ìœ„í•´ í•„ìš”

# ì´ë¯¸ì§€ ë†’ì´ì™€ ë„ˆë¹„ ì„¤ì •
img_height, img_width = 80, 120

# ì´ë¯¸ì§€ ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ ì •ì˜
transform = transforms.Compose([
    transforms.Resize((img_height, img_width)),  # ì´ë¯¸ì§€ í¬ê¸° ì¡°ì •
    transforms.ToTensor(),                       # ì´ë¯¸ì§€ë¥¼ í…ì„œë¡œ ë³€í™˜ (0~1 ë²”ìœ„ë¡œ ì •ê·œí™”ë¨)
])

# ì‚¬ìš©ì ì •ì˜ ë°ì´í„°ì…‹ í´ë˜ìŠ¤ ì •ì˜
class ImageDataset(Dataset):
    def __init__(self, file_list, labels, transform=None):
        self.file_list = file_list  # ì´ë¯¸ì§€ íŒŒì¼ ê²½ë¡œ ë¦¬ìŠ¤íŠ¸
        self.labels = labels        # ì´ë¯¸ì§€ì— í•´ë‹¹í•˜ëŠ” ë¼ë²¨ ë¦¬ìŠ¤íŠ¸
        self.transform = transform  # ì „ì²˜ë¦¬ í•¨ìˆ˜

    def __getitem__(self, index):
        # ì¸ë±ìŠ¤ì— í•´ë‹¹í•˜ëŠ” ì´ë¯¸ì§€ ì—´ê¸°
        img = Image.open(self.file_list[index])
        
        # ì „ì²˜ë¦¬ê°€ ì •ì˜ë˜ì–´ ìˆìœ¼ë©´ ì ìš©
        if self.transform is not None:
            img = self.transform(img)
        
        # ì¸ë±ìŠ¤ì— í•´ë‹¹í•˜ëŠ” ë¼ë²¨ ê°€ì ¸ì˜¤ê¸°
        label = self.labels[index]
        
        return img, label  # ì´ë¯¸ì§€ì™€ ë¼ë²¨ ë°˜í™˜

    def __len__(self):
        return len(self.labels)  # ë°ì´í„°ì…‹ì˜ ì „ì²´ ê¸¸ì´ ë°˜í™˜

# ë°ì´í„°ì…‹ ê°ì²´ ìƒì„±
image_dataset = ImageDataset(file_list, labels, transform=transform)

# ë°ì´í„°ì…‹ì—ì„œ ì¼ë¶€ ì´ë¯¸ì§€ë¥¼ ì‹œê°í™”
fig = plt.figure(figsize=(10, 6))
for i, example in enumerate(image_dataset): 
    if i >= 6:  # ìµœëŒ€ 6ì¥ë§Œ í‘œì‹œ
        break
    ax = fig.add_subplot(2, 3, i+1)  # 2í–‰ 3ì—´ subplot ë°°ì¹˜
    ax.set_xticks([])  # xì¶• ëˆˆê¸ˆ ì œê±°
    ax.set_yticks([])  # yì¶• ëˆˆê¸ˆ ì œê±°
    ax.imshow(example[0].numpy().transpose((1, 2, 0)))  # ì±„ë„ ìˆœì„œ ë³€ê²½ í›„ ì´ë¯¸ì§€ í‘œì‹œ
    # ax.set_title(f'{example[1]}', size=15)  # ë¼ë²¨ì„ ì œëª©ìœ¼ë¡œ í‘œì‹œ

plt.tight_layout()  # ë ˆì´ì•„ì›ƒ ì •ë¦¬
plt.show()  # ì´ë¯¸ì§€ ì¶œë ¥

```
![image](https://github.com/user-attachments/assets/e0574e76-c497-4661-9843-9256c44db1d8)

```
import torchvision
import torch
from itertools import islice

image_path = './'

mnist_dataset = torchvision.datasets.MNIST(image_path, 'train', download=True)

assert isinstance(mnist_dataset, torch.utils.data.Dataset)

example = next(iter(mnist_dataset))
print(example)


fig = plt.figure(figsize=(15, 6))
for i, (image, label) in islice(enumerate(mnist_dataset), 10):
    ax = fig.add_subplot(2, 5, i+1)
    ax.set_xticks([]); ax.set_yticks([])
    ax.imshow(image, cmap='gray_r')
    ax.set_title(f'{label}', size=15)


#plt.savefig('figures/12_06.pdf')
plt.show()
```
![image](https://github.com/user-attachments/assets/94368cb2-839c-4877-93b5-84728c8f4125)
