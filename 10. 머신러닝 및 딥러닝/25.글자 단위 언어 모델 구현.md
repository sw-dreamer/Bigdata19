# 글자 단위 언어 모델 구현

```
import torch
import torch.nn as nn
import pandas as pd
import numpy as np
```
```
# 데이터 로딩
# 파일 읽기
with open('./1268-0.txt','r',encoding='utf-8') as fp:
    text = fp.read()

print(text)
```
![image](https://github.com/user-attachments/assets/92f64326-d248-49c6-9db7-b3c2ea052d05)

```
start_idx=text.find('THE MYSTERIOUS ISLAND')
print(start_idx)
```
![image](https://github.com/user-attachments/assets/6a3379cb-5729-4b0f-9147-094ef0510868)

```
end_idx=text.find('End of the Project')
print(end_idx)
```
![image](https://github.com/user-attachments/assets/11134ea9-53fc-4481-9ba2-0479468e07f7)

```
text=text[start_idx:end_idx]
print(text)
```
![image](https://github.com/user-attachments/assets/eac9db17-03f6-40cf-8442-cc811a89c11c)

```
char_set=set(text)
print(char_set)
```
![image](https://github.com/user-attachments/assets/61a406b0-d24e-4e88-b950-348c838d7397)

```
len(char_set)
```
![image](https://github.com/user-attachments/assets/5a5e0fd6-d879-4069-952f-78fecfd30081)

```
print(len(text))
```
![image](https://github.com/user-attachments/assets/b1693be3-0eba-4941-8619-437c98efc3f0)

```
# 인코딩 : 문자 => 숫자, 디코딩 : 숫자 => 문자
# 인코딩
# char_set 정렬
chars_sorted=sorted(char_set)
print(chars_sorted)
```
![image](https://github.com/user-attachments/assets/1caa1427-926f-463f-a40d-594ce7096c90)

```
# 한자씩 인코딩 -> 숫자
char2int={ch:i for i, ch in enumerate(chars_sorted)}
print(char2int)
```
![image](https://github.com/user-attachments/assets/a6f26a63-58f7-4ad5-9d4a-a3717db399e5)
```
# 한 숫자씩 디코딩 => 문자
char_array=np.array(chars_sorted)
print(char_array)
```
![image](https://github.com/user-attachments/assets/0295af6f-2565-463e-b56c-a681916c9244)

```
# text 인코딩
text_encode=np.array(
    [char2int[ch] for ch in text]
    ,dtype=np.int32
)
# 앞에서 10개
print(text[:10])
print(text_encode[:10])
```
![image](https://github.com/user-attachments/assets/fa6ba8e0-2132-47c4-97bd-7c3697e5c9f1)



