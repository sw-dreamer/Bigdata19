# 파이토치를 사용하여 심층 신경망 구현

```
# MNIST 데이터 로딩
import torch
import torchvision
from torchvision import transforms

image_path = './'
transform = transforms.Compose(
    [transforms.ToTensor()]
)

mnist_dataset = torchvision.datasets.MNIST(
    root=image_path,
    train=True,
    transform=transform,
    download=True
)

from torch.utils.data import Subset
mnist_valid_dataset = Subset(
    mnist_dataset,
    torch.arange(10000)
)
mnist_train_dataset = Subset(
    mnist_dataset, 
    torch.arange(10000, len(mnist_dataset))
)
mnist_test_dataset = torchvision.datasets.MNIST(
    root=image_path,
    train=False,
    transform=transform,
    download=False
)
```
![image](https://github.com/user-attachments/assets/cdd5b9c8-27ee-41d8-a61f-d6388efcbcd4)

```
from torch.utils.data import DataLoader

batch_size = 64
torch.manual_seed(1)
train_dl = DataLoader(mnist_train_dataset, batch_size, shuffle=True)
valid_dl = DataLoader(mnist_valid_dataset, batch_size, shuffle=False)
```
```
import torch.nn as nn

# Sequential 생성 : 계산 그래프 정의
# nn.Sequential()을 사용하여 각 레이어를 순차적으로 쌓을 수 있는 모델 객체를 생성
model = nn.Sequential()

# 첫번째 CNN 층을 추가
model.add_module(
    'conv1',  # 레이어의 이름 (모델에 출력될 때 사용)
    nn.Conv2d(  # 2D 합성곱 층 정의
        in_channels=1,  # 입력 채널 수 (흑백 이미지라 1채널)
        out_channels=32,  # 출력 채널 수 (32개의 필터를 사용하여 특징 추출)
        kernel_size=5,  # 커널 크기 (5x5 크기의 필터 사용)
        padding=2  # 패딩 (패딩을 2로 설정해 출력 크기가 입력 크기와 동일하도록 유지)
    )
)

# 첫 번째 ReLU 활성화 함수 추가
model.add_module('relu1', nn.ReLU())  # ReLU는 비선형 활성화 함수로, 음수 값을 0으로 바꾸고 양수는 그대로 둠

# 첫 번째 MaxPooling 층 추가
model.add_module('pool1', nn.MaxPool2d(kernel_size=2))  # 2x2 풀링 (이미지 크기를 절반으로 줄임)

# 두번째 CNN 층 추가
model.add_module(
    'conv2',  # 레이어 이름
    nn.Conv2d(  # 두 번째 2D 합성곱 층 정의
        in_channels=32,  # 입력 채널 수 (이전 레이어의 출력이 32개의 채널로 나오므로 32)
        out_channels=64,  # 출력 채널 수 (64개의 필터를 사용하여 더 많은 특징 추출)
        kernel_size=5,  # 커널 크기 (5x5 크기의 필터 사용)
        padding=2  # 패딩 (입력 이미지 크기와 동일하게 유지)
    )
)

# 두 번째 ReLU 활성화 함수 추가
model.add_module('relu2', nn.ReLU())  # 두 번째 ReLU 활성화 함수로 비선형성을 추가

# 두 번째 MaxPooling 층 추가
model.add_module('pool2', nn.MaxPool2d(kernel_size=2))  # 2x2 풀링 (이미지 크기를 또 절반으로 줄임)

model
```
![image](https://github.com/user-attachments/assets/d7e3b559-8954-4b05-b007-623fa9919527)

```
x=torch.ones(
    (4,1,28,28)
)
print(f'x shape : {x.shape}')
print(f' model(x) shape : {model(x).shape}')
```
![image](https://github.com/user-attachments/assets/868a15eb-f7bc-40dc-be6f-6fd588adc32f)
